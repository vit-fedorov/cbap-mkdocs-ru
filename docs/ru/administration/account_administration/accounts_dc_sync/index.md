---
title: Синхронизация с сервером каталогов (Active Directory)
kbId: 2308
---

# Синхронизация с сервером каталогов (Active Directory) {: #accounts_dc_sync}

## Механизм синхронизации с сервером каталогов (Active Directory)

Для подключения к серверу каталогов (например, Active Directory (AD)) используется заданное имя или IP адрес сервера. При необходимости возможно указать номер порта через двоеточие в строке адреса сервера. **{{ productName }}** задаёт авторизованные (IANA) порты для безопасного и небезопасного соединения. Если сервер поддерживает безопасную передачу данных, укажите LDAPS (LDAP с шифрованием по SSL или TLS) порт 636 для установления данного соединения, в противном случае сервером будет выбран LDAP порт 389. Так же необходимо указать базовое имя (DN) – запись в директории, из которой будут выполняться поисковые запросы. Базовое DN LDAP похоже на путь в файловой системе, но указывается в следующем порядке: первым – относительное отличительное имя (RDN) и далее поднимается по дереву слева направо. Например, базовое имя (DN) может выглядеть следующим образом: «*CN=Иван Иванов, OU=Users, DC=example, DC=com*». Базовое имя ограничивает доступ к системе Active Directory.

Предусмотрены следующие режимы синхронизации:

- принудительный — режим, при котором краткосрочные соединения создаются пользователем при нажатии кнопок «**Проверить соединение**», «**Синхронизировать**», «**Получить перечень групп из AD**»;
- событийный — режим, при котором фоновое соединение создаётся один раз при нажатии кнопки «**Сохранить**» и остаётся открытым до следующего изменения настроек. Любое изменение группы на сервере AD (то есть событие) приводит к синхронизации с Системой.
- по расписанию — режим, при котором соединение создаётся каждый раз согласно указанному расписанию.

Все изменения пользователей на сервере AD синхронизируются с Системой только принудительно или по расписанию.

!!! Примечание

    - После смены домена Active Directory во время синхронизации обновятся данные аккаунтов, при этом сохранится привязка аккаунтов к [ролям в приложении]({{ kbArticleURLPrefix }}2208) и [системным ролям]({{ kbArticleURLPrefix }}2175).
    - Если на стороне Active Directory у аккаунта сменилось имя пользователя, в Системе будет создан новый аккаунт.

Система хранит данные о версии загружаемого объекта. При создании повторного соединения, система запрашивает данные, проверяет версию каждого объекта, если она изменилась, то данные синхронизируются.

**Типы синхронизации:**

- синхронизация всех пользователей — в Системе создаются все пользователи, которые состоят в RDN;
- выбор групп для синхронизации — можно выбрать группы, которые состоят в RDN; в Системе создаются группы, подгруппы и аккаунты, состоящие в выбранных группах; в Системе не отображается, что подгруппа состоит в группе.

Определение соответствия данных группы производится следующим образом:
{: .pageBreakAfterAvoid}

<table>
<thead>
<tr>
<th colspan=2>Comindware Business Application Platform</th>
<th>Active Directory</th>
</tr>
<tr>
<th>Системное имя</th>
<th>Отображаемое название</th>
<th>Системное имя</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>Название</td>
<td>CN</td>
</tr>
<tr>
<td>Description</td>
<td>Описание</td>
<td>Description</td>
</tr>
<tr>
<td>members</td>
<td>Участники группы</td>
<td>Member</td>
</tr>
<tr>
<td>parentGroups</td>
<td>Входит в группы</td>
<td>MemberOf</td>
</tr>
<tr>
<td>Username</td>
<td>Имя пользователя</td>
<td>SamAccountName</td>
</tr>
<tr>
<td>IsActive</td>
<td>Активен (логический атрибут)</td>
<td>IsEnabled</td>
</tr>
<tr>
<td>Mbox</td>
<td>Адрес эл.почты</td>
<td>Mail</td>
</tr>
<tr>
<td>FullName</td>
<td>Имя</td>
<td>FullName</td>
</tr>
<tr>
<td>Title</td>
<td>Должность</td>
<td>Title</td>
</tr>
<tr>
<td>Department</td>
<td>Отдел</td>
<td>Department</td>
</tr>
<tr>
<td>Office</td>
<td>Офис</td>
<td>PhysucakDeliveryOfficeName</td>
</tr>
<tr>
<td>Skype</td>
<td>Skype</td>
<td>Pager</td>
</tr>
<tr>
<td>Manager</td>
<td>Руководитель</td>
<td>ManagerID</td>
</tr>
<tr>
<td>Phone</td>
<td>Телефон</td>
<td>TelephoneNumber, Mobile</td>
</tr>
<tr>
<td>Authentification=LDAP</td>
<td>Метод проверки подлинности</td>
<td></td>
</tr>
<tr>
<td>Picture</td>
<td>Аватар</td>
<td></td>
</tr>
</tbody>
</table>

## Механизм авторизации через сервер каталогов (Active Directory)

После ввода адреса эл. почты или имени пользователя и пароля на начальной странице Система идентифицирует аккаунт в собственной базе данных. Если аккаунт существует в базе данных Системы и у него указана проверка подлинности по LDAP или по федеративной аутентификации, то Система посылает запрос в Active Directory или Active Directory Federation Services для аутентификации имени пользователя и пароля. В случае успеха создаётся токен сеанса, который при последующих веб-запросах автоматически передаётся в Систему и позволяет ей получить информацию о текущем пользователе для авторизации запроса. В собственной базе данных Система пароль не хранит.

Если в свойствах аккаунта изменить **Способ аутентификации** на **Локальную аутентификацию**, то авторизация пользователя будет проходить локально. Администратор может сменить пароль аккаунта непосредственно в Системе, в таком случае при последующей синхронизации с Active Directory пароль не будет перезаписан. Пароль хранится в базе данных Системы.

## Настройка подключения к серверу каталогов (Active Directory)

Инструкции по настройке подключения к серверу каталогов см. в следующих статьях:

{% if completeGuide or userGuide or kbExport %}

- **{{ productName }}**
    - **[Сервер каталогов. Настройка подключения][ad_connection]**
- **Linux**
    - **[Аутентификация через Active Directory. Настройка контроллера домена и экземпляра ПО][ad_authentication_configure_dc_instance]**
    - **[Аутентификация через единый вход (SSO). Настройка контроллера домена, экземпляра ПО и компьютера конечного пользователя][sso_authenticatation_configure]**
- **Windows**
    - **[Настройка единого входа (SSO-аутентификации) в ОС Windows][sso_authentication_configure_windows]**

{% elif adminGuideLinux %}

- **[Сервер каталогов. Настройка подключения][ad_connection]**
- **[Аутентификация через Active Directory. Настройка контроллера домена и экземпляра ПО][ad_authentication_configure]**
- **[Аутентификация через единый вход (SSO). Настройка контроллера домена, экземпляра ПО и компьютера конечного пользователя][sso_authenticatation_configure]**

{% elif adminGuideWindows %}

- **[Сервер каталогов. Настройка подключения][ad_connection]**
- **[Настройка единого входа (SSO-аутентификации) в ОС Windows][sso_authentication_configure_windows]**

{% endif %}

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
