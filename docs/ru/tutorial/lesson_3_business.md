---
title: Урок 3. Мой первый бизнес-процесс
kbId: 4874
---

# Урок 3. Мой первый бизнес-процесс

## Введение

Усовершенствуем приложение, созданное в предыдущем уроке, — создадим автоматизированный процесс заказа корпоративного автотранспорта: *Заказчик* создает заявку, *Секретарь* согласовывает заявку, после чего одобренная заявка переходит к *сотруднику Гаража*, который принимает заявку и, в зависимости от наличия автомобилей в гараже, либо выполняет рейс, либо отказывает в заявке.

**Предусловия:**

- Пройден [Урок 2. Мой первый реестр данных](https://kb.comindware.ru/article.php?id=4873):
    - создан реестр данных (**шаблон записи**) *«Заявка на автомобиль»*;
    - создана экранная форма.

**Расчетная продолжительность:** 20 мин.

{% include-markdown ".snippets/tutorial_version_notice.md" %}

!!! question "Определения"

    {%
    include-markdown "business_apps/templates/template_types/process_templates.md"
    start="<!--process-definitions-start-->"
    end="<!--process-definitions-end-->"
    rewrite-relative-urls=false
    %}

## Создание шаблона процесса

Перейдем к созданию шаблона процесса…

1. На панели навигации слева выберите пункты «**Настройки**» — «**Шаблоны**».
2. Перейдите на вкладку «**Шаблоны процессов**».
3. Нажмите кнопку «**Создать**».
4. Введите название шаблона — *«Заказ автотранспорта»*.
5. Укажите приложение — *«Управление автопарком».*
6. В поле «**Связанный шаблон**» выберите шаблон *«Заявка на автомобиль».*
7. Нажмите кнопку «**Создать**».

_![Создание шаблона бизнес-процесса](https://kb.comindware.ru/assets/img_624211d191c96.png)_

## Диаграмма бизнес-процесса

!!! note "Примечание"

    При создании **диаграммы** (схемы) **бизнес-процесса** используется **нотация BPMN 2.0**.

    Выбор BPMN объясняется достаточной простотой и понятностью для бизнеса, а однозначная интерпретация применяемых символов обеспечивает одинаковое понимание процесса бизнесом, аналитиком и ИТ-специалистами.

1. Перейдите на вкладку «**Диаграмма**».
2. Отобразится конструктор диаграммы бизнес-процесса.

_![Конструктор диаграммы бизнес-процесса](https://kb.comindware.ru/assets/img_6474b4fe24021.png)_

!!! question "Определения"

    Конструктор диаграммы бизнес-процесса состоит из трех частей, показанных на иллюстрации.

    **(1)** Панель элементов, которые можно добавить на схему: 

    - **Действия** — задачи и подпроцессы:

        - **задачи** — **пользовательские** (ввод данных участником процесса через экранную форму) и автоматические (выполнение сценария, вызов сервиса);
        - **подпроцессы** — **вызов процесса** и **встроенный подпроцесс**;

    - **События** — **начальное, промежуточное и конечное**;
    - **Развилки**— «**или/или**», «**и**» (параллельная);
    - **Общие элементы** — **дорожка**, **поток управления**, **комментарий**.

    **(2)** **Диаграмма** (графическая схема) бизнес-процесса.

    **(3)** Кнопки: **Выбрать версию**, **Очистить**, **Восстановить**, **Опубликовать**, **Проверить**, **Экспортировать**. 

## Построение диаграммы бизнес-процесса

Перетащите элементы с левой панели на диаграмму.

Для начала добавим дорожки…

1. Перетащите три дорожки на схему процесса. Элемент «**Дорожка**» расположен в группе «**Общие элементы**».

    _![Перетаскивание дорожек на диаграмму бизнес-процесса](https://kb.comindware.ru/assets/img_6474b5d703bee.png)_

2. Присвойте дорожкам названия: *Заказчик, Секретарь, Гараж.*
3. Для переименования дорожки выберите дорожку и в раскрывающемся меню элемента нажмите кнопку «**Свойства**» *‌*.

    _![Переименование дорожек](https://kb.comindware.ru/assets/img_6474b60ff00c9.png)_

4. В отобразившемся окне «**Свойства дорожки**» введите новое название и нажмите кнопку «**Сохранить**».

    _![Свойства дорожки](https://kb.comindware.ru/assets/img_630cf6afe2115.png)_

    !!! question "Определения"

        **Дорожка** используется для визуального представления участников процесса. Дорожки могут настраиваться произвольным образом по усмотрению проектировщика процесса, но чаще всего это либо подразделение, либо должность, либо роль. Например, в нашем процессе *Заказчик* — это роль (заказчик может быть из любого подразделения), *Гараж* — подразделение, *Секретарь* — должность.

5. Удалите конечное событие. Для этого выберите его и в меню элемента нажмите кнопку «**Удалить**» *‌*.

    _![Удаление элементов диаграммы](https://kb.comindware.ru/assets/img_6474bb4fe8bcb.png)_

6. Перетащите элемент «**Пользовательская задача**» из раздела «**Действия**» с левой панели на дорожку «Секретарь».*

    !!! question "Определения"

        **Пользовательская задача** представляет собой задачу, выполняемую человеком. При переходе процесса на этот шаг задача автоматически назначается исполнителю или становится доступной для нескольких исполнителей. 

7. Укажите название задачи — *«Согласовать заявку»*. Для этого дважды щелкните имя задачи.
8. Присоедините поток управления от начального события к пользовательской задаче *«Согласовать заявку».*
9. Перетащите элемент «**Развилка** «**или/или**» на диаграмму и соедините его с задачей *«Согласовать заявку».*
10. Присоедините к развилке два потока управления.
11. Присвойте развилке название — *«Одобрена?»*. Для этого дважды щелкните развилку и введите ее название или нажмите кнопку «**Свойства**» *‌*в меню элемента.

    _![Диаграмма бизнес-процесса — развилка «или/или»](https://kb.comindware.ru/assets/img_6474bc1892f2b.png)_

    !!! question "Определения"

        **Развилка «или/или»** используется для описания альтернативных потоков процесса, когда может быть выбран только один из путей.
        Для каждого потока, выходящего из развилки, (для каждой стрелки) указывается условие (логическое выражение), определяющее, когда по нему пойдет процесс.
        Кроме того, можно выбрать поток «**иначе**» (по умолчанию), по которому процесс пойдет в том случае, если ни одно из условий на стрелках не выполнено. 
        Если *Секретарь* отказал в заявке, то *Заказчик* получает уведомление об этом, после чего процесс завершится. Если заявка одобрена *Секретарем*, то дальше её согласовывает *сотрудник Гаража*.

12. **Покажем это на схеме...**
13. От развилки «Одобрена?» добавьте две пользовательских задачи: *«Вам отказано»* на дорожку *«Заказчик»* и *«Принять заявку»* на дорожку *«Гараж»*.
14. Выберите развилку и в меню элемента нажмите кнопку «**Свойства**» *‌*. Отобразится окно «**Свойства развилки** «**или/или**».
15. На вкладке «**Дополнительные**» укажите названия исходящих потоков — *«Да»* и *«Нет»*, дважды щелкнув соответствующие поля. Нажмите кнопку «**Сохранить**».

    _![Дополнительные свойства развилки](https://kb.comindware.ru/assets/img_62421ddb915ae.png)_

16. От задачи *«Вам отказано»* добавьте конечное событие.
17. Введите название конечного события — *«Отказ»*.

    _![Диаграмма бизнес-процесса с задачами «Согласовать заявку», «Принять заявку», «Вам отказано» и конечным событием «Отказ»](https://kb.comindware.ru/assets/img_630cfa4f951d0.png)_

    !!! question "Определения"

        **События в BPMN** можно трактовать как статусы процесса — старт, промежуточные вехи, варианты завершения. Начальное событие у процесса, как правило, один, а конечных событий несколько — процесс может завершиться как успехом, так и неудачей. 
        
        После принятия заявки сотрудник *Гаража* проверяет наличие автомобиля для выполнения заявки — при отсутствии автомобиля заявка возвратится *Секретарю*.

18. От задачи *«Принять заявку»* добавьте элемент «**Развилка** «**или/или**».
19. Добавьте соединительную линию от развилки к задаче *«Согласовать заявку».*
20. Укажите имя развилки — *«Есть машина?».*

    _![Развилка «Есть машина?»](https://kb.comindware.ru/assets/img_630cfacf012e3.png)_

    При наличии машины *Заказчик* получит уведомление *«Машина выделена»*, а *сотрудники Гаража* приступят к выполнению рейса.

21. Добавьте элемент «**Развилка** «**и**» от развилки *«Есть машина?»*.

    !!! question "Определения"

        **Развилка «и»** (параллельная) используется для разделения потока на несколько путей, которые будут выполняться одновременно. 

22. От ***развилки «и»*** добавьте две пользовательских задачи: для *Заказчика* — *«Машина выделена»* и для сотрудника *Гаража* — *«Выполнить рейс»*.
23. Укажите названия для исходящих потоков от развилки *«Есть машина?» — «Да»* и *«Нет»*.
24. Добавьте еще одну **развилку «и»** и соедините с ней задачи *«Машина выделена»* и *«Выполнить рейс»*.
25. Добавьте конечное событие и назовите его *«Успех».*
26. В итоге должна получиться следующая диаграмма:

    _![Диаграмма бизнес-процесса заказа автотранспорта](https://kb.comindware.ru/assets/img_630cf4c1ba376.png)_

!!! warning "Логика бизнес-процесса"

    Чтобы закрепить пройденный материал, опишем диаграмму бизнес-процесса словами.

    1. *Заказчик* создает заявку.
    2. *Секретарь* согласовывает заявку:
        1. если *Секретарь* одобрил заявку, то выполняется шаг 4;
        2. если *Секретарь* отклонил заявку, то выполняется шаг 3.
    3. Заказчик получает уведомление о том, что ему отказано в заявке. Процесс заказа автотранспорта завершается отказом.
    4. Сотрудник *Гаража* принимает заявку:
        1. в случае наличия машины он передает заявку на выполнение *Водителю* — выполняется шаг 5;
        2. в случае отсутствия машины заявка возвращается *Секретарю* — на шаг 2.
    5. *Заказчик* получает уведомление о том, что машина выделена, а *Водитель* приступает к выполнению рейса.
    6. Процесс завершается успехом. 

## Настройка форм пользовательских задач

Для начала нам настроим стартовую форму, которая будет отображаться для *Заказчика* при запуске процесса.

1. Выберите на диаграмме «**Начальное событие**» и в раскрывшемся меню элемента нажмите кнопку «**Стартовая форма**».

    _![Настройка стартовой формы](https://kb.comindware.ru/assets/img_6242c88d61712.png)_

2. Откроется конструктор стартовой формы. 

3. Для формы задачи используем созданную ранее форму для согласования заявки.
4. Перетащите с панели элементов форму *«Заявка на автомобиль — Основная форма»* на макет формы. Нажмите кнопку «**Сохранить**». Вернитесь к диаграмме процесса, нажав кнопку «**Назад**» в браузере.

    _![Настройка и сохранение стартовой формы](https://kb.comindware.ru/assets/img_6242c79bcc30c.png)_

5. Теперь настроим форму пользовательской задачи, которая будет отображаться исполнителю — *Секретарю*.
6. Выберите задачу *«Согласовать заявку»* и в меню элемента нажмите кнопку «**Форма**».

    _![Настройка формы задачи](https://kb.comindware.ru/assets/img_630dd9be8f57a.png)_

7. Отобразится конструктор формы задачи.
8. Разверните элемент *«Заявка на автомобиль»* на панели элементов слева и перетащите форму *«Заявка на автомобиль — Основная форма»* на макет формы.

9. Поля формы заявки должны быть недоступны для редактирования, поэтому изменим режим доступа к ним.
10. Выберите добавленную форму заявки и на панели свойств укажите режим **доступа** «**Только чтение**».
11. Перетащите на макет формы под форму заявки на автомобиль элемент «**Область**» и присвойте ей название *«Одобрение»* с помощью панели свойств.
12. Перетащите в область *«Одобрение»* атрибут *«Одобрено»* из панели элементов.
13. Сохраните форму и вернитесь к схеме процесса, нажав кнопку «**Назад**» в браузере.

    _![Создание формы для задачи «Согласование заявки»](https://kb.comindware.ru/assets/img_6242ca5762591.png)_

**Перейдем к настройке формы задачи, которую будет выполнять сотрудник гаража...**

1. Выберите задачу *«Принять заявку»* на диаграмме процесса и в меню элемента нажмите кнопку «**Форма**». Отобразится конструктор формы.
2. Перетащите форму *«Заявка на автомобиль — Основная форма»*на макет формы.
3. Укажите для дочерней формы режим **доступа** « **Только чтение**», чтобы сотрудник гаража не мог редактировать заявку.

    !!! note "Примечание"

    Вы можете добавлять атрибуты «на лету», например во время создания экранной формы.
    Сотрудник *Гаража* должен принять или отклонить заявку в зависимости от наличия автомобилей в гараже. Поэтому добавим соответствующий атрибут.

4. Нажмите кнопку «**Добавить атрибут**» *‌* рядом с пунктом *«Заявка на автомобиль».*

    _![Добавление атрибута на лету](https://kb.comindware.ru/assets/img_6242cf399e118.png)_

5. В отобразившемся окне свойств атрибута выберите **тип данных** «**Логический**» и укажите название *«Принято»*.
6. Нажмите кнопку «**Сохранить**».

    _![Создание и сохранение нового логического атрибута](https://kb.comindware.ru/assets/img_6242d05396bea.png)_

7. Перетащите на макет формы элемент «**Область**» и переименуйте её в *«Принятие заявки»* с помощью панели свойств.
8. Перетащите созданный атрибут *«Принято»* на область *«Принятие заявки».*
9. Выберите поле *«Принято»* и на панели свойств укажите способ отображения: «**Отображать как**» — «**Переключатель**».
10. Нажмите кнопку «**Сохранить**» и вернитесь к схеме процесса с помощью кнопки «**Назад**» браузера.

    _![Добавление на форму логического элемента и настройка способа его отображения](https://kb.comindware.ru/assets/img_6242ea7cef096.png)_

Если заявка не была одобрена, *Заказчик* должен быть проинформирован об этом, поэтому форма пользовательской задачи в этом случае содержит только текст *«Вам отказано»* и данные заявки.

1. Выберите на диаграмме процесса задачу *«Вам отказано»* и в меню элемента нажмите кнопку «**Форма**». Отобразится конструктор формы.
2. Перетащите на макет формы новую **область** и переименуйте её в «Вам отказано» с помощью панели свойств.
3. На левой панели разверните элемент *«Заявка на автомобиль»* и перетащите форму *«Заявка на автомобиль — Основная форма»* под область *«Вам отказано».*
4. На панели свойств формы укажите режим **доступа** «**Только чтение**».
5. Сохраните форму и вернитесь к диаграмме процесса.

    _![ Установка для формы режима доступа «Только чтение» ](https://kb.comindware.ru/assets/img_6242eb4550d79.png)_

6. Аналогичным образом настройте форму для задачи *«Машина выделена»* — добавьте на форму область *«Машина выделена»* и дочернюю форму *«Заявка на автомобиль — Основная форма»*. Установите для дочерней формы режим **доступа** «**Только для чтения**». Сохраните форму и вернитесь к диаграмме процесса.

    _![Настройка формы задачи «Машина выделена»](https://kb.comindware.ru/assets/img_6242eda939124.png)_

7. Настройте форму для задачи *«Выполнить рейс»* — добавьте на форму область *«Выполнить рейс»* и  и дочернюю форму *«Заявка на автомобиль — Основная форма»*. Установите для дочерней формы режим **доступа** «**Только для чтения**». Сохраните форму и вернитесь к диаграмме процесса.

## Настройка развилок

Перейдем к настройке потоков управления после развилок. На нашей диаграмме есть две развилки — *«Одобрена?»* и *«Есть машина?»*.

1. Выберите развилку *«Одобрена»* и в меню элемента нажмите кнопку «**Свойства**» *‌*. Откроется страница свойств развилки.

    _![Переход к свойствам развилки](https://kb.comindware.ru/assets/img_630ddb236ffb9.png)_

2. На вкладке «**Дополнительные**» для потока к задаче *«Вам отказано»* установите флажок «**Поток** «**иначе**».

    _![Выбор потока «иначе»](https://kb.comindware.ru/assets/img_630ddbdd6ba96.png)_

    !!! question "Определения"

        **Поток управления** «**иначе**» (по умолчанию) — это тот поток, по которому пойдет процесс в том случае, если условия на всех остальных потоках не выполняются (значение логического выражения — «ложь»). 
        Поток, по которому пойдёт процесс после развилки *«Одобрена?»*, задаёт логический атрибут *«Одобрено»*, который *Секретарь* заполняет при согласовании заявки.

3. Составим выражение для условия, при выполнении которого процесс пойдет дальше. Для этого нам потребуется системное имя атрибута *«Одобрено».*
4. На вкладке «**Дополнительные**»  нажмите ячейку «**Условие**» в строке потока к задаче *«Принять заявку»*. Отобразится компактный редактор выражения.

    _![Переход к настройке выражение для потока управления](https://kb.comindware.ru/assets/img_630ddd385695f.png)_

5. Так как атрибут *«Одобрено»* логического типа, то при составлении выражения необходимо обратиться к его системному имени…
6. Введите символ `$` и в отобразившемся раскрывающемся списке дважды нажмите системное имя атрибута *«Одобрено»* — `Odobreno`.
7. Нажмите кнопку с зелёным флажком.
8. Нажмите кнопку «**Сохранить**».

    _![Ввод и сохранение выражения для доступа к атрибуту «Одобрено» в потоке управления](https://kb.comindware.ru/assets/img_6242f148ce947.png)_

    !!! note "Примечание"

        Символ `$` используется, чтобы обратиться к тому или иному атрибуту текущего объекта. В данном случае мы сможем получить информацию о значении атрибута «Одобрено» — ложь или истина (`true` или `false`). 

Поток, по которому пойдёт процесс после развилки *«Есть машина?»*, задаёт логический атрибут *«Принято»*, который указывает сотрудник гаража.

1. Выберите развилку *«Есть машина?»* и в меню элемента нажмите кнопку «**Свойства**»**.**
2. Перейдите на вкладку «**Дополнительные**».
3. Введите для потока *«Да»* выражение с системным именем атрибута *«Принято»*. Нажмите кнопку с зелёным флажком.

    _![Ввод и сохранение выражения для доступа к атрибуту «Принято» в потоке управления](https://kb.comindware.ru/assets/img_6242f3cfe1d9e.png)_

4. Установите для потока к задаче «Согласовать заявку» флажок «**Поток** «**иначе**».
5. Нажмите кнопку «**Сохранить**».

    _![Выбор потока управления по умолчанию и сохранение свойств развилки](https://kb.comindware.ru/assets/img_6245cae9309b2.png)_

## Настройка исполнителей задач

Укажем исполнителей для пользовательских задач…

1. Выберите пользовательскую задачу «Согласовать заявку» и в меню элемента нажмите кнопку «**Свойства**» ‌.

    _![Переход к странице настройки свойств задачи](https://kb.comindware.ru/assets/img_6245ca5d8ec98.png)_

2. На вкладке «**Дополнительные**» выберите исполнителя в раскрывающемся списке «**Исполнители**».
3. Введите заголовок задачи *«Заказ автотранспорта — Согласовать заявку».*

    _![Выбор исполнителя задачи](https://kb.comindware.ru/assets/img_624307517bd57.png)_

4. Нажмите кнопку «**Сохранить**».

Аналогично укажите **исполнителей** и **заголовки задач**: *«Принять заявку», «Выполнить рейс»* (для упрощения на этапе отладки процесса укажем исполнителем этих задач одного и того же пользователя).

Для задач *«Вам отказано»* и *«Машина выделена»* сделаем исполнителя вычисляемым — это должен быть пользователь, который инициировал процесс, то есть *Заказчик*.

1. Выберите задачу *«Вам отказано»* и в меню элемента нажмите кнопку «**Свойства**» ‌. Отобразится окно «**Свойства пользовательской задачи**».
2. На вкладке «**Дополнительные**» в поле «**Исполнители**» выберите пункт «**Атрибут**».
3. Нажмите стрелку вниз в поле «**Исполнители**».
4. Выберите атрибут «**Создатель**» (`_creator`).
5. Введите **заголовок задачи** *«Заказ автотранспорта — Вам отказано».*
6. Нажмите кнопку «**Сохранить**».

    _![Назначение исполнителя задачи по атрибуту _creator ](https://kb.comindware.ru/assets/img_6243086d0f8e3.png)_

    !!! tip "Системный атрибут «Создатель»"

        Мы использовали **системный атрибут** создателя шаблона процесса —  «**Создатель**» (`_creator`), чтобы указать в качестве исполнителя задачи пользователя, инициировавшего процесс.

7. Аналогичным образом задайте заголовок задачи и назначьте исполнителем инициатора процесса для задачи *«Машина выделена».*

## Проверка и публикация процесса

Мы настроили шаблон бизнес-процесса. Чтобы изменения вступили в силу, его необходимо опубликовать. Диаграммы бизнес-процессов рекомендуется публиковать каждый раз после внесения изменений.

Перед публикацией следует проверить корректность диаграммы…

1. Нажмите кнопку «**Проверить**» в конструкторе диаграммы процесса.

    !!! note "Примечание"

        При возникновении ошибок элемент, в котором присутствует ошибка, подсвечивается красным цветом. Если диаграмма настроена правильно, то отобразится сообщение «**Ошибок нет**», после чего диаграмму можно публиковать. 

2. Нажмите кнопку «**Опубликовать**».

_![Проверка и публикация диаграммы ](https://kb.comindware.ru/assets/img_6474bda89ce1d.png)_

## Тестирование: запуск бизнес-процесса и «Мои задачи»

Мы настроили и опубликовали бизнес-процесс, теперь можем перейти к его тестированию в роли пользователя.

1. Перейдите на вкладку «**Свойства**» шаблона процесса.

2. Нажмите кнопку «**Перейти к экземплярам**».

    _![Переход к списку экземпляров бизнес-процесса](https://kb.comindware.ru/assets/img_62430417c72be.png)_

3. В отобразившемся списке «**Все записи**» нажмите кнопку «**Создать**». Отобразится стартовая форма процесса.

4. Заполните форму и нажмите кнопку «**Создать**».

    _![Создание новой заявки на автомобиль](https://kb.comindware.ru/assets/img_6243047d6c516.png)_

5. Созданный бизнес-процесс отобразится в списке.

6. Проверим наличие задачи «Согласовать заявку», в которой мы указали своего текущего пользователя исполнителем.
7. Перейдите в «**Мои задачи**» в панели навигации слева. 

    _![Переход в раздел «Мои задачи» из списка процессов](https://kb.comindware.ru/assets/img_6243051dcd1ab.png)_

8. Отобразится список назначенных вам активных задач.

9. Откройте задачу из списка, дважды нажав ее в списке.

    _![Список активных задач пользователя](https://kb.comindware.ru/assets/img_624305b30669d.png)_

10. Отобразится форма согласования заявки на автомобиль.

11. Установите флажок *«Одобрено»* и нажмите кнопку «**Завершить задачу**».

    _![Одобрение заявки на автомобиль и завершение задачи](https://kb.comindware.ru/assets/img_624309b31d192.png)_

12. Перейдите в раздел «**Мои задачи**». В списке появится задача *«Заказ автотранспорта — Принять заявку».*
13. Для атрибута *«Принято»* укажите значение *«Нет»* и завершите задачу.

    _![Отклонение заявки на автомобиль и ее возврат Секретарю](https://kb.comindware.ru/assets/img_6243067199fb0.png)_

14. Вернитесь к списку своих задач — в списке появится задача *«Заказ автотранспорта — Согласовать заявку»*.
15. Откройте задачу и снимите флажок *«Одобрено»*.
16. Завершите задачу.
17. Перейдите в раздел «**Мои задачи**». В списке задач появится задача *«Заказ автотранспорта — Вам отказано»*. Завершите задачу. Бизнес-процесс будет завершен.

## Результаты

Поздравляем! Вы создали свой первый бизнес-процесс, настроили для него формы задач и протестировали запуск и исполнение задач процесса.

В  [следующем уроке](https://kb.comindware.ru/article.php?id=4865)  вы узнаете, как отследить историю запущенного процесса, и настроите информационные страницы с диаграммами для просмотра статистики за период.

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
