<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4698" title="Интеграция с 1С по OData">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-подключения">
<span class="md-ellipsis">
      Настройка подключения
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-интеграции">
<span class="md-ellipsis">
      Настройка интеграции
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>В <strong>Comindware Platform</strong> можно настраивать интеграции с внешними службами посредством OData без помощи разработчиков — силами аналитика. Для этого достаточно настроить подключение к внешней службе и сопоставление атрибутов между приложением и внешней службой.</p>
<p>После настройки интеграции синхронизацию данных между приложением и внешней службой можно запускать как вручную, так и автоматически.</p>
<p>Здесь представлен пример настройки интеграции с 1С.</p>
<h2 id="настройка-подключения">Настройка подключения</h2>
<ol class="colored_numbers_list">
<li>Создайте новое <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4702">подключение для <strong>синхронизации с веб-сервисом</strong></a>.</li>
<li>
<p>Настройте свойства подключения:</p>
<ul>
<li><strong>Название</strong> — наглядное наименование подключения, например <em>1С</em>.</li>
<li><strong>Тип исходящего подключения</strong> — <strong>OData</strong>.</li>
<li><strong>Адрес веб-сервиса</strong> — введите URL-адрес OData-сервера 1C.</li>
<li><strong>Тип аутентификации</strong> — <strong>Обычная</strong>.<ul>
<li><strong>Имя пользователя</strong> — введите логин для подключения к OData-серверу 1C.</li>
<li><strong>Пароль</strong> — введите пароль для подключения к OData-серверу 1C.</li>
</ul>
</li>
<li><strong>Версия</strong> <strong>OData</strong> — выберите версию протокола OData, которую поддерживает OData-сервер 1C, например V3.</li>
<li><strong>Заголовок</strong> — при необходимости введите заголовки HTTP-запроса к OData-серверу 1C.</li>
</ul>
</li>
<li>
<p>Нажмите кнопку «<strong>Проверить соединение</strong>».</p>
</li>
<li>В случае успешного соединения в области «<strong>Результаты</strong>» отобразится список справочников из базы данных 1С. В случае неуспешного соединения — сообщение «<strong>Произошла ошибка</strong>». В таком случае проверьте правильность введенных данных и наличие прав на доступ к службе 1С у пользователя, под которым настраиваете аутентификацию.</li>
<li>Сохраните подключение.</li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Настройка подключения к OData-сервису" src="/platform/v5.0/administration/connections_communication_routes/rest_odata_connections/img/1c_connection_odata_settings.png"/><figcaption class="caption">Настройка подключения к OData-сервису</figcaption></p>
</figure>
<h2 class="pageBreakBefore" id="настройка-интеграции">Настройка интеграции</h2>
<ol class="colored_numbers_list">
<li>Откройте приложение, в котором будете настраивать интеграцию</li>
<li>
<p>Выберите пункт «<strong>Интеграции</strong>».</p>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Расположение раздела «Интеграции»" src="/platform/v5.0/administration/connections_communication_routes/rest_odata_connections/img/1c_connection_integrations_section.png"/><figcaption class="caption">Расположение раздела «Интеграции»</figcaption></figure></p>
</li>
<li>
<p>Нажмите кнопку «<strong>Создать</strong>».</p>
</li>
<li>Отобразится окно свойств интеграции.</li>
<li>
<p>Настройте параметры на вкладке «<strong>Основные настройки</strong>»:</p>
<ul>
<li><strong>Название</strong> — введите наглядное название интеграции, например <em>«Номенклатурные объекты»</em>.</li>
<li><strong>Подключение по</strong> <strong>OData</strong> — выберите ранее созданное подключение для синхронизации с веб-сервисом, например <em>«1С»</em>.</li>
<li><strong>Тип</strong> — <strong>Импорт</strong>.</li>
<li><strong>Шаблон записи</strong> — шаблон записи, в который будут импортироваться данные, например <em>«(1С) Номенклатура. Объекты»</em>.</li>
<li><strong>Внешняя сущность</strong> — источник данных, из которого будут импортироваться данные в шаблон, например <em>«Catalog_Номенклатура»</em>.</li>
<li><strong>Какие объекты синхронизировать</strong> — <strong>Все</strong>.</li>
<li><strong>Тип запуска</strong> — <strong>Вручную</strong>.</li>
<li><strong>Преобразование атрибутов</strong> — настройте сопоставление атрибутов между <strong>шаблоном записи</strong> и <strong>внешней сущностью</strong>:<ul>
<li><strong>Внутренние данные</strong> — укажите атрибуты шаблона записи, в которые будут записываться импортируемые данные;</li>
<li><strong>Внешние данные</strong> — укажите атрибут <strong>внешней сущности</strong>, из которых будут импортироваться данные (в нашем примере это поля справочника <em>«Catalog_Номенклатура»</em>);</li>
<li><strong>Ключевое свойство</strong> — укажите пару атрибутов, являющихся первичными ключами (primary_key). Если при импорте записи совпадут значения этих атрибутов в имеющейся записи в шаблоне и в импортируемой записи, то запись в шаблоне будет обновлена импортируемыми данными. В противном случае в шаблоне будет создана новая запись с импортированными данными.</li>
</ul>
</li>
</ul>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Настройка основных свойств интеграции в приложении" src="/platform/v5.0/administration/connections_communication_routes/rest_odata_connections/img/1c_connection_properties_settings.png"/><figcaption class="caption">Настройка основных свойств интеграции в приложении</figcaption></figure></p>
</li>
<li>
<p>Настройте параметры вкладку «<strong>Настройки импорта</strong>»:</p>
<ul>
<li><strong>Зависит от</strong> — выберите другую интеграцию, синхронизацию по которой необходимо запускать перед текущей интеграцией. В нашем примере выбрана интеграция <em>«Единица изм.»</em>, потому что в записях в шаблоне <em>«(1С) Номенклатура. Объекты»</em> указаны единицы измерения и их необходимо актуализировать перед импортом данных.</li>
</ul>
</li>
<li>
<p>При необходимости настройте параметры постпроцессинга:</p>
<ul>
<li><strong>Добавить новую настройку постпроцессинга</strong> — нажмите эту кнопку, чтобы настроить устанавливать значения в атрибутах типа «<strong>Запись</strong>» посредством сопоставления значений ключевых атрибутов в импортируемых записях и связанных записях.</li>
<li><strong>Целевой атрибут</strong> — выберите атрибут типа «<strong>Запись</strong>» к которому требуется привязать имеющиеся записи из связанного шаблона, например «<em>Ед.Изм.</em>».</li>
<li><strong>Атрибут в выбранном шаблоне</strong> — выберите атрибут из шаблона записи, связанного с атрибутом <em>«Ед.изм.»</em>, в котором хранятся уникальные значения, с которыми будут сравниваться значения <strong>атрибута в ссылочном шаблоне</strong>;</li>
<li><strong>Атрибут в ссылочном шаблоне</strong> — выберите атрибут из шаблона «<em>1С_Номенклатуры.Объекты</em>», в который будут импортироваться уникальные идентификаторы единиц измерения из базы данных 1C.</li>
</ul>
<div class="notice notice-warning">
<p class="admonition-title">Логика постпроцессинга</p>
<p>Постпроцессинг позволяет привязать импортируемые записи к имеющимся записям в связанном шаблоне.</p>
<p>В таблице «<strong>Преобразование атрибутов</strong>» необходимо выбрать ключевые атрибуты связанных шаблонов записи, содержащие уникальные идентификаторы записей, которые требуется связать между собой посредством <strong>целевого атрибута</strong>.</p>
<p>Эти значения будут сравниваться при импорте записей. Если значения ключевых атрибутов в импортируемой записи и в имеющейся записи связанного шаблона совпадут, то эти записи будут связаны посредством выбранного <strong>целевого атрибута</strong>.</p>
</div>
</li>
<li>
<p>Сохраните интеграцию.</p>
</li>
<li>В списке интеграций установите флажок выбора у настроенной интеграции и нажмите «<strong>Запуск синхронизации</strong>».</li>
<li>Затем перейдите в журналы, откройте таблицу «<strong>Интеграция по OData</strong>».</li>
<li>При неудачных интеграциях ознакомьтесь с журналом для более детальной информации об ошибках.</li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Настройки импорта данных из 1C" src="/platform/v5.0/administration/connections_communication_routes/rest_odata_connections/img/1c_connection_import.png"/><figcaption class="caption">Настройки импорта данных из 1C</figcaption></p>
</figure>
<figure class="screenshot_with_caption">
<p><img alt="Журнал сеансов интеграции по OData" src="/platform/v5.0/administration/connections_communication_routes/rest_odata_connections/img/1c_connection_log.png"/><figcaption class="caption">Журнал сеансов интеграции по OData</figcaption></p>
</figure>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4702">Синхронизация с веб-сервисом. Настройка подключения</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4697">Синхронизация с веб-сервисом. Интеграция по OData</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4673">Журналы событий</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>