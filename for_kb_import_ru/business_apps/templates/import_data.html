<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4802" kb-title="Импорт данных в шаблон">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#порядок-импорта-данных">
<span class="md-ellipsis">
      Порядок импорта данных
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#подготовка-импортируемого-файла">
<span class="md-ellipsis">
      Подготовка импортируемого файла
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#практический-пример">
<span class="md-ellipsis">
      Практический пример
    </span>
</a>
<nav aria-label="Практический пример" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#подготовка-исходных-данных">
<span class="md-ellipsis">
      Подготовка исходных данных
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#импорт-данных-в-шаблоны">
<span class="md-ellipsis">
      Импорт данных в шаблоны
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>Функция импорта данных предусмотрена для шаблонов записей, шаблонов аккаунтов, шаблонов оргединиц и шаблонов ролей.</p>
<p>Поддерживается импорт данных из файлов Excel и CSV.</p>
<h2 id="порядок-импорта-данных">Порядок импорта данных</h2>
<ol class="colored_numbers_list">
<li>Откройте шаблон записи и выберите вкладку «<strong>Импорт</strong>».</li>
<li>Прикрепите файл XLSX или CSV в поле «<strong>Файл с данными</strong>».</li>
<li>Откроется форма настройки импорта данных.</li>
<li>
<p>Настройте параметры импорта данных.</p>
<ul>
<li><strong>Кодировка</strong> — выберите кодировку импортируемого файла.</li>
<li><strong>Разделитель столбцов</strong> — выберите разделитель, используемый в импортируемом файле. Это поле отображается файлов формата CSV.</li>
<li><strong>Часовой пояс</strong> — выберите часовой пояс загружаемых дат.</li>
<li><strong>Игнорировать ошибки парсинга</strong> — установите этот флажок, чтобы загружать данные, даже если в процессе импорта возникли ошибки.</li>
<li>
<p><strong>Обновить существующие записи данными из файла</strong> — установите этот флажок, чтобы обновить имеющиеся записи данными из соответствующих строк импортируемого файла и создать отсутствующие записи. Если этот флажок не установлен, для каждой строки в импортируемом файле будет создана новая запись.</p>
<ul>
<li><strong>Столбец</strong> — выберите ключевой столбец импортируемой таблицы. Ячейки в этом столбце должны содержать уникальные <strong>текстовые</strong> значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях. Имеющиеся записи будут обновлены импортированными данными из соответствующих строк. Для остальных строк будут созданы новые записи с импортированными данными.</li>
<li><strong>Ключевой атрибут</strong> — выберите атрибут, по значениям которого импортируемые строки будут сопоставляться с имеющимися записями в шаблоне.</li>
</ul>
</li>
<li>
<p><strong>Сопоставление данных</strong> — настройте соответствие столбцов импортируемого файла атрибутам шаблона.</p>
<ul>
<li><strong>Столбец</strong> — заголовок столбца импортируемой таблицы.</li>
<li><strong>Атрибут</strong> — выберите атрибут, в который требуется импортировать значения из столбца. Если оставить это поле пустым, то соответствующий столбец не будет импортирован.</li>
<li><strong>Формат</strong> — выберите формат импортируемой ячейки в соответствии с типом атрибута. См. <a class="mkdocs_imported_link" href="#подготовка-импортируемого-файла">требования к импортируемому файлу</a>.<ul>
<li>Для атрибута типа «<strong>Дата и время</strong>» выберите пункт «<strong>Не задано</strong>» (автоматическое преобразование данных) или формат, соответствующий представлению данных в импортируемом файле.</li>
<li>Для атрибута типа «<strong>Число</strong>» или «<strong>Длительность</strong>» выберите формат, соответствующий представлению данных в импортируемом файле.</li>
<li>Для атрибута типа «<strong>Запись</strong>», «<strong>Роль</strong>» или «<strong>Организационная единица</strong>» выберите атрибут связанного шаблона <strong>ID</strong> или атрибут <strong>Name</strong> — это <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4769">атрибут-заголовок записей</a> связанного шаблона. Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к связанному шаблону.</li>
<li>Для атрибута типа «<strong>Аккаунт</strong>» выберите атрибут шаблона аккаунта: <strong>ID</strong>, <strong>Адрес эл. почты</strong>, <strong>Имя пользователя</strong> или <strong>Ф. И. О.</strong> Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к аккаунтам.</li>
<li>Для атрибутов остальных типов формат данных выбирать не требуется, данные будут преобразованы автоматически.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Нажмите кнопку «<strong>Загрузить</strong>».</p>
</li>
<li>В случае успешного импорта отобразится сообщение «<strong>Данные импортированы</strong>».</li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Настройка импорта данных из файла CSV" src="/platform/v5.0/business_apps/templates/img/import_settings.png"/><figcaption class="caption">Настройка импорта данных из файла CSV</figcaption></p>
</figure>
<h2 class="pageBreakBefore" id="подготовка-импортируемого-файла">Подготовка импортируемого файла</h2>
<p>Для корректного импорта данных в шаблон файл в формате XLSX следует подготовить, как указано ниже.</p>
<ul>
<li>Все импортируемые данные должны находиться на первом листе. Остальные листы при импорте будут пропущены.</li>
<li>Первая строка листа должна содержать текстовые заголовки для всех столбцов.</li>
<li>По возможности удалите столбцы, которые не требуется импортировать.</li>
<li>Для импорта значений атрибута типа «<strong>Число</strong>» задайте формат ячеек «<strong>Числовой</strong>».</li>
<li>Для импорта значений атрибута типа «<strong>Дата и время</strong>» задайте формат ячеек  «<strong>Дата</strong>» или «<strong>Время</strong>».</li>
<li>Для импорта значений атрибута типа «<strong>Длительность</strong>» задайте формат ячеек «<strong>Время</strong>».</li>
<li>
<p>Для импорта значений атрибута типа «<strong>Логический</strong>» задайте формат ячеек «<strong>Общий</strong>» или «<strong>Текстовый</strong>».</p>
<ul>
<li>Ячейки должны содержать значения <code>ИСТИНА</code> или ЛОЖЬ (либо <code>TRUE</code> или <code>FALSE</code>). Пустое значение в ячейке будет преобразовано в значение <code>ложь</code>.</li>
</ul>
</li>
<li>
<p>Для импорта значений атрибута типа «<strong>Запись</strong>», «<strong>Аккаунт</strong>», «<strong>Роль</strong>» или «<strong>Организационная единица</strong>» задайте формат ячеек «<strong>Общий</strong>» или «<strong>Текстовый</strong>».</p>
<ul>
<li>Эти ячейки должны содержать уникальные значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях из связанного шаблона.</li>
<li>По совпадающим значениям будет сформирована связь между импортируемыми записями и имеющимися записями в связанном шаблоне.</li>
<li>Для остальных импортированных строк в данном атрибуте будет установлено пустое значение. </li>
<li>Для привязки нескольких записей импортируемые ячейки должны содержать ключевые значения, разделённые точками с запятыми без пробелов.</li>
</ul>
</li>
<li>
<p>Для остальных ячеек задайте формат «<strong>Общий</strong>» или «<strong>Текстовый</strong>».</p>
</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Если в ячейке Excel находится формула, то будет импортировано результирующее значение, вычисленное по формуле, с учётом формата ячейки.</p>
</div>
<h2 class="pageBreakBefore" id="практический-пример">Практический пример</h2>
<p>Рассмотрим пример импорта заявлений на отпуск и решений по ним из файлов формата XLSX в два связанных между собой шаблона: <em>Заявления на отпуск</em> и <em>Решения по заявлениям на отпуск</em>. В примере воспользуемся функциями обновления имеющихся записей и установления связей между записями по ключевым атрибутам.</p>
<h3 id="подготовка-исходных-данных">Подготовка исходных данных</h3>
<ol class="colored_numbers_list">
<li>Создайте <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4653">accounts</a> с перечисленными ниже <strong>Ф. И. О.</strong>: <em>Иванов И. И., Кулагина А. Н., Филиппов К. В., Журавлёва Т. С., Игнатьев А. Б.</em> Остальные свойства аккаунтов заполните произвольными сведениями.</li>
<li>
<p>Создайте шаблон записи <em>«Заявления на отпуск»</em> с указанными ниже атрибутами.</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Название атрибута</th>
<th>Тип данных</th>
<th>Свойства атрибута</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>№ заявления</em></td>
<td>Текст</td>
<td><strong>Использовать как заголовок записей:</strong> флажок установлен<br/><strong>Контролировать уникальность значений:</strong> флажок установлен</td>
</tr>
<tr>
<td><em>Заявитель</em></td>
<td>Аккаунт</td>
<td></td>
</tr>
<tr>
<td><em>Дата начала</em></td>
<td>Дата и время</td>
<td></td>
</tr>
<tr>
<td><em>Длительность отпуска</em></td>
<td>Число</td>
<td><strong>Количество знаков после запятой:</strong> <strong>0</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Вынесите созданные атрибуты на <em>основную форму</em> и в таблицу «<em>Все записи</em>» шаблона <em>«Заявления на отпуск».</em></p>
</li>
<li>
<p>Создайте шаблон записи <em>«Решения по заявлениям на отпуск»</em>  с указанными ниже атрибутами.</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Название атрибута</th>
<th>Тип данных</th>
<th>Свойства атрибута</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Заявления</em></td>
<td>Запись</td>
<td><strong>Связанный шаблон:</strong> <em>Заявления на отпуск</em><br/><strong>Хранить несколько значений:</strong> флажок установлен</td>
</tr>
<tr>
<td><em>Руководитель</em></td>
<td>Аккаунт</td>
<td></td>
</tr>
<tr>
<td><em>Решение</em></td>
<td>Логический</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Вынесите созданные атрибуты на <em>основную форму</em> и в таблицу «<em>Все записи</em>» шаблона <em>«Решения по заявлениям на отпуск».</em></p>
</li>
<li>
<p>Создайте файл <code>_Заявления_на_отпуск.XLSX_</code> и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).</p>
<table style="width: 100%;">
<thead>
<tr>
<th>№ заявления</th>
<th>Ф. И. О. заявителя</th>
<th>Дата заявления</th>
<th>Длительность</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>1</em></td>
<td><em>Иванов И. И.</em></td>
<td>16.02.2024</td>
<td><em>5</em></td>
</tr>
<tr>
<td><em>2</em></td>
<td><em>Кулагина А. Н.</em></td>
<td>25.03.2024</td>
<td><em>20</em></td>
</tr>
<tr>
<td><em>3</em></td>
<td><em>Филиппов К. В.</em></td>
<td>01.08.2024</td>
<td><em>15</em></td>
</tr>
<tr>
<td><em>4</em></td>
<td><em>Журавлёва Т. С.</em></td>
<td>15.05.2024</td>
<td><em>30</em></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Задайте формат ячеек в файле <code>_Заявления_на_отпуск.XLSX_</code>, как указано ниже.</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Столбец</th>
<th>Формат ячеек</th>
</tr>
</thead>
<tbody>
<tr>
<td>№ заявления</td>
<td><strong>Общий</strong></td>
</tr>
<tr>
<td>Ф. И. О. заявителя</td>
<td><strong>Текстовый</strong></td>
</tr>
<tr>
<td>Дата начала</td>
<td><strong>Дата</strong></td>
</tr>
<tr>
<td>Длительность</td>
<td><strong>Числовой<br/>Количество знаков после запятой: 0</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Создайте файл <code>_Решения_по_заявлениям_на_отпуск.XLSX_</code> и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).</p>
<table style="width: 100%;">
<thead>
<tr>
<th>№ заявления</th>
<th>Руководитель</th>
<th>Решение</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>1;2</em></td>
<td><em>Игнатьев А. Б.</em></td>
<td><em>ЛОЖЬ</em></td>
</tr>
<tr>
<td><em>3;4</em></td>
<td><em>Игнатьев А. Б.</em></td>
<td><em>TRUE</em></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Задайте формат ячеек в файле <code>_Решения_по_заявлениям_на_отпуск.XLSX_</code>, как указано ниже.</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Столбец</th>
<th>Формат ячеек</th>
</tr>
</thead>
<tbody>
<tr>
<td>№ заявления</td>
<td><strong>Общий</strong></td>
</tr>
<tr>
<td>Руководитель</td>
<td><strong>Текстовый</strong></td>
</tr>
<tr>
<td>Решение</td>
<td><strong>Общий</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Создайте в шаблоне записи <em>«Заявления на отпуск»</em> одну запись и заполните её поля следующими данными:</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Поле</th>
<th>Значение</th>
</tr>
</thead>
<tbody>
<tr>
<td>№ заявления</td>
<td><em>1</em></td>
</tr>
<tr>
<td>Заявитель</td>
<td><em>Филиппов К. В.</em></td>
</tr>
<tr>
<td>Дата начала</td>
<td><em>25.03.2024</em></td>
</tr>
<tr>
<td>Длительность отпуска</td>
<td><em>30</em></td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 class="pageBreakBefore" id="импорт-данных-в-шаблоны">Импорт данных в шаблоны</h3>
<ol class="colored_numbers_list">
<li>Откройте шаблон <em>«Заявления на отпуск»</em> и выберите вкладку «<strong>Импорт</strong>».</li>
<li>В поле «<strong>Файл с данными</strong>» выберите файл <em>Заявления_на_отпуск.XLSX.</em></li>
<li>
<p>Установите флажок «<strong>Обновить существующие записи данными из файла</strong>» и настройте обновление:</p>
<ul>
<li><strong>Столбец:</strong> <em>№ заявления</em></li>
<li><strong>Ключевой атрибут:</strong> <em>№ заявления</em></li>
</ul>
</li>
<li>
<p>Настройте <strong>сопоставление данных</strong> следующим образом:</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Столбец</th>
<th>Атрибут</th>
<th>Формат</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>№ заявления</em></td>
<td><em>№ заявления</em></td>
<td></td>
</tr>
<tr>
<td><em>Дата начала</em></td>
<td><em>Дата начала</em></td>
<td><strong>Не задано</strong></td>
</tr>
<tr>
<td><em>Длительность</em></td>
<td><em>Длительность отпуска</em></td>
<td><strong>Целое число</strong></td>
</tr>
<tr>
<td><em>Ф. И. О. заявителя</em></td>
<td><em>Заявитель</em></td>
<td><strong>Ф. И. О.</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Нажмите кнопку «<strong>Загрузить</strong>».</p>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Настройка импорта данных в шаблон «Заявления на отпуск»" src="/platform/v5.0/business_apps/templates/img/import_settings_to_vacations.png"/><figcaption class="caption">Настройка импорта данных в шаблон «Заявления на отпуск»</figcaption></figure></p>
</li>
<li>
<p>Перейдите на вкладку «<strong>Свойства</strong>» шаблона <em>«Заявления на отпуск»</em> и нажмите кнопку «<strong>Перейти к экземплярам</strong>»</p>
</li>
<li>Отобразится список всех заявлений на отпуск.</li>
<li>
<p>Заявление № 1 должно быть обновлено и должны появиться три новых заявления в соответствии с импортированными данными.</p>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Импортированные заявления на отпуск" src="/platform/v5.0/business_apps/templates/img/import_added_records_to_vacation.png"/><figcaption class="caption">Импортированные заявления на отпуск</figcaption></figure></p>
</li>
<li>
<p>Откройте шаблон <em>«Решения по заявлениям на отпуск»</em> и выберите вкладку «<strong>Импорт</strong>».</p>
</li>
<li>В поле «<strong>Файл с данными</strong>» выберите файл <em>Заявления_на_отпуск.XLSX.</em></li>
<li>
<p>Настройте <strong>сопоставление данных</strong> следующим образом:</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Столбец</th>
<th>Атрибут</th>
<th>Формат</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>№ заявления</em></td>
<td><em>Заявления</em></td>
<td><strong>Name</strong></td>
</tr>
<tr>
<td><em>Решение</em></td>
<td><em>Решение</em></td>
<td></td>
</tr>
<tr>
<td><em>Руководитель</em></td>
<td><em>Дата начала</em></td>
<td><strong>Ф. И. О.</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Нажмите кнопку «<strong>Загрузить</strong>».</p>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Настройка импорта данных в шаблон «Решения по заявлениям на отпуск»" src="/platform/v5.0/business_apps/templates/img/import_data_settings.png"/><figcaption class="caption">Настройка импорта данных в шаблон «Решения по заявлениям на отпуск»</figcaption></figure></p>
</li>
<li>
<p>Перейдите на вкладку «<strong>Свойства</strong>» шаблона <em>«Решения по заявлениям на отпуск»</em> и нажмите кнопку «<strong>Перейти к экземплярам</strong>»</p>
</li>
<li>Отобразится список всех решений по заявлениям.</li>
<li>В списке должно быть два решения, каждое по двум заявлениям на отпуск.</li>
<li>Перейдите на вкладку «Свойства» шаблона <em>«Заявления на отпуск»</em>  и нажмите кнопку «Перейти к экземплярам»</li>
<li>
<p>Отобразится два решения, каждое по двум заявлениям на отпуск.</p>
<p><figure class="screenshot_with_caption" markdown=""><img alt="Импортированные решения по заявлениям на отпуск" src="/platform/v5.0/business_apps/templates/img/import_added_records_to_decisions.png"/><figcaption class="caption">Импортированные решения по заявлениям на отпуск</figcaption></figure></p>
</li>
</ol>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4709">Шаблоны. Определения, создание, настройка, перенос между приложениями, архивирование, очистка, удаление</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4769">Атрибут-заголовок записей шаблона</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4653">Аккаунты. Создание, настройка, замещение, привязка к шаблону аккаунта, назначение лицензий, удаление</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>