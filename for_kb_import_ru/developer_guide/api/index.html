<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4860" kb-tags="" kb-title="Введение в API">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#стратегия-выбора-api">
<span class="md-ellipsis">
      Стратегия выбора API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#обратная-совместимость-api">
<span class="md-ellipsis">
      Обратная совместимость API
    </span>
</a>
<nav aria-label="Обратная совместимость API" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#solution-api">
<span class="md-ellipsis">
      Solution API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#system-core-api">
<span class="md-ellipsis">
      System Core API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#web-api">
<span class="md-ellipsis">
      Web API
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#definitions">
<span class="md-ellipsis">
      Определения
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#доступ-к-api">
<span class="md-ellipsis">
      Доступ к API
    </span>
</a>
<nav aria-label="Доступ к API" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#методы-api">
<span class="md-ellipsis">
      Методы API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#инициация-запроса-из-внешней-системы">
<span class="md-ellipsis">
      Инициация запроса из внешней системы
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#аутентификация-внешних-систем-при-доступе-к-api">
<span class="md-ellipsis">
      Аутентификация внешних систем при доступе к API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#инициация-запроса-к-внешней-системе">
<span class="md-ellipsis">
      Инициация запроса к внешней системе
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#аутентификация-при-доступе-к-api-внешних-систем">
<span class="md-ellipsis">
      Аутентификация при доступе к API внешних систем
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#использование-swagger">
<span class="md-ellipsis">
      Использование Swagger
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#пример-вызова-метода-system-core-api">
<span class="md-ellipsis">
      Пример вызова метода System Core API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p><strong>Comindware Platform</strong> может обращаться к API внешних систем через <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4675">подключения</a> и <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4676">пути передачи данных</a>, а также может обрабатывать запросы из внешних систем через интерфейсы <strong>REST API</strong> трёх типов:</p>
<ul>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4863"><strong>Solution API</strong></a> — обеспечивает доступ к актуальной модели и бизнес-логике конкретного приложения.</li>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4862"><strong>System Core API</strong></a> — предоставляет доступ к системным функциям (управление аккаунтами, системными службами и т.д.).</li>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4861"><strong>Web API</strong></a> — универсальные методы прикладного уровня для работы с данными (излечение записей, базовые CRUD-операции).</li>
</ul>
<h2 id="стратегия-выбора-api">Стратегия выбора API</h2>
<p>Перед выбором API ознакомьтесь с параграфом <em>«<a class="mkdocs_imported_link" href="#обратная-совместимость-api"><strong>Обратная совместимость API</strong></a>»</em>.</p>
<p>Помимо обратной совместимости, при выборе API следует учесть все технические и бизнес-факторы, включая потенциальные затраты на обновление интеграций в случае устаревания используемых API.</p>
<p>Чтобы выбрать оптимальные API в соответствии с целями и потребностям вашего предприятия, обязательно привлеките системных аналитиков, бизнес-аналитиков и представителей коммерческих отделов вашей организации.</p>
<p>В общем случае можно рекомендовать следующий подход к выбору API:</p>
<ul>
<li>Для интеграций с бизнес-логикой приложений используйте <strong>Solution API</strong>. При этом предусмотрите механизм обработки изменений логики работы приложений.</li>
<li>Для системных задач (аутентификация, настройки) используйте <strong>System Core API</strong>. Учитывайте, что при обновлении мажорной версии ПО (например, с 4.2 на 5.0) может потребоваться обновить код интеграций.</li>
<li>Для стабильных и долгосрочных интеграций отдавайте предпочтение <strong>Web API</strong>. Эти интерфейсы обладают наибольшей обратной совместимостью.</li>
</ul>
<h2 id="обратная-совместимость-api">Обратная совместимость API</h2>
<p>Для API <strong>Comindware Platform</strong> различных типов применяются разные политики обратной совместимости.</p>
<h3 id="solution-api">Solution API</h3>
<ul>
<li><strong>Обратная совместимость</strong>: не гарантируется и может меняться в при внесении изменений в приложения, за исключением метаданных (например, базовой структуры сущностей <strong>Comindware Platform</strong>).</li>
<li><strong>Рекомендации</strong>: используйте для интеграций, где требуется доступ к текущей модели приложения. Учитывайте, что модель данных и логика работы приложения методы могут меняться по мере его развития.</li>
</ul>
<h3 id="system-core-api">System Core API</h3>
<ul>
<li><strong>Обратная совместимость</strong>: поддерживается в рамках мажорной версии (например, 5.x.x). Методы сохраняют стабильность, но в новых минорных версиях могут быть реализованы новые параметры или возможности с сохранением совместимости.</li>
<li><strong>Рекомендации</strong>: при обновлении мажорной версии (например, с 4.x.x на 5.0.0) проверяйте документацию на наличие изменений. Для минорных версий (например, 5.1 и 5.2) совместимость сохраняется.</li>
</ul>
<h3 id="web-api">Web API</h3>
<ul>
<li><strong>Обратная совместимость</strong>: полностью гарантирована. Методы остаются стабильными между всеми версиями <strong>Comindware Platform</strong> (например, 4.x.x и 5.x.x).</li>
<li><strong>Рекомендации</strong>: оптимально подходит для долгосрочных интеграций. Изменения вносятся только в исключительных случаях, с сохранением обратной совместимости.</li>
</ul>
<div class="notice notice-success">
<h2 class="admonition-title" id="definitions">Определения</h2>
<ul>
<li><strong>API</strong> (Application Programming Interface) — это интерфейс прикладного программирования — набор методов, классов, библиотек и функций, обеспечивающих возможность взаимодействия между системами.</li>
<li><strong>REST API</strong> — это API, соответствующий архитектуре Representational State Transfer (передача репрезентативного состояния). Преимуществами REST API являются возможность оптимального использования протокола HTTP, масштабирования сервисов и разработки приложений с использованием практически любых языков программирования с соблюдением принципов проектирования REST:<ul>
<li>отсутствие сохранения состояния на сервере — каждый поступающий запрос содержит все необходимые для обработки данные и обрабатывается независимо от других запросов;</li>
<li>единообразный интерфейс — сервер передаёт информацию в стандартном формате;</li>
<li>независимость клиента и сервера — клиент может взаимодействовать с сервером только посредством URI ресурса, а сервер может лишь передавать на клиент запрошенные данные посредством HTTP;</li>
<li>возможность кэширования ресурсов — ответы содержат данные о кэшируемости, запрашиваемые многократно ресурсы могут кэшироваться на стороне сервера или клиента;</li>
<li>многоуровневая архитектура системы — клиент может подключаться к авторизованным посредникам между клиентом и сервером, чтобы получать ответы от сервера, а сервер может передавать запросы другим серверам;</li>
<li>код по запросу — сервер может расширить возможности клиента, передав исполняемый код, например, для проверки введённых пользователем данных.</li>
</ul>
</li>
<li><strong>RESTful</strong> — это веб-служба, реализующая архитектуру <strong>REST</strong>.</li>
<li><strong>Ресурс</strong> — это объект или информация в приложении, например шаблон, аккаунт или документ, доступ к которым предоставляет API.</li>
<li><strong>URI ресурса</strong> — это универсальный идентификатор ресурса в API.</li>
<li><strong>Клиент</strong> — это человек или система, которые осуществляют доступ к ресурсам посредством API.</li>
</ul>
</div>
<h2 id="доступ-к-api">Доступ к API</h2>
<p>В простейшем случае <strong>RESTful</strong>-службы отправляют и получают HTTP-запросы в строке URL-адреса для получения и отправки данных, запуска команд и выполнения других действий.</p>
<p>Все интеграции с помощью <strong>REST API</strong> настраиваются по одному принципу:</p>
<ul>
<li>составьте сценарий интеграции — какая система инициирует вызов API, как часто, какие методы она использует для передачи каких данных, что потом происходит и т. д.;</li>
<li>используйте документацию по API для тестирования запросов, настройки подключения и формирования финальных «рабочих» запросов.</li>
</ul>
<h3 id="методы-api">Методы API</h3>
<p><strong>Comindware Platform</strong> поддерживает следующие методы API.</p>
<ul>
<li><code>GET</code> — получить данные об объекте.</li>
<li><code>DELETE</code> — удалить объект.</li>
<li><code>POST</code> — создать новый объект.</li>
<li><code>PUT</code> — изменить данные объекта.</li>
</ul>
<h3 id="инициация-запроса-из-внешней-системы">Инициация запроса из внешней системы</h3>
<p><strong>Comindware Platform</strong> может принимать HTTP-запросы к <strong>API</strong> двумя способами:</p>
<ul>
<li>Запрос <code>GET</code> или <code>DELETE</code> в виде URL-строки, содержащей все параметры запроса.<ul>
<li>Внешняя система отправляет запрос в строке URL. Заготовку запроса для внешней системы можно сформировать в интерфейсе <a class="mkdocs_imported_link" href="#использование-swagger">Swagger</a>.</li>
<li>Такой запрос можно проверить с помощью браузера: скопируйте полученный <strong>Request URL</strong> в адресную строку и нажмите клавишу <code>Enter</code>. Если вы уже вошли в систему в этом браузере, аутентификация не потребуется.</li>
</ul>
</li>
<li>Запрос <code>POST</code> или <code>PUT</code> с телом, содержащим все параметры (например, имя пользователя и пароль, данные, которые необходимо отправить или получить и т. д.).<ul>
<li>Внешняя система отправляет запрос в формате JSON или XML. Заготовку запроса для внешней системы можно сформировать в интерфейсе <a class="mkdocs_imported_link" href="#использование-swagger">Swagger</a>.</li>
<li>Этот вариант является более гибким, позволяя передать гораздо больше данных в структурированном виде. Но такой запрос нельзя протестировать с помощью браузера. Для тестирования можно использовать встроенный веб-интерфейс Swagger или такие службы, как Postman, SoapUI, Insomnia и т. п.</li>
</ul>
</li>
<li><strong>Comindware Platform</strong> возвращает ответ формате JSON или XML.</li>
</ul>
<h3 id="аутентификация-внешних-систем-при-доступе-к-api">Аутентификация внешних систем при доступе к API</h3>
<p>API <strong>Comindware Platform</strong> поддерживает два способа аутентификации внешних систем:</p>
<ul>
<li>Basic-аутентификация — требуется передать имя пользователя и пароль аккаунта, от имени которого будет выполняться запрос;</li>
<li>HMAC —  требуется передать токен и секретный ключ, сформированные для аккаунта на странице «<strong>Администрирование</strong>» – «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4674">Ключи аутентификации</a></strong>».</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<ul>
<li>Для использования методов API и интерфейса <a class="mkdocs_imported_link" href="#использование-swagger">Swagger</a> следует создать специальный аккаунт и предоставить предоставить ему разрешение «<strong>Вызов API</strong>» в системной роли. См. <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4662">Системные роли. Определения, настройка, объединение, удаление</a>»</em>. Кроме того, API и Swagger могут использовать пользователи, входящие в системную роль «<strong>Системные администраторы</strong>».</li>
<li>При вызове методов API в интерфейсе <a class="mkdocs_imported_link" href="#использование-swagger">Swagger</a> на странице <code>https://your-host/docs</code> уже выполнен вход в <strong>Comindware Platform</strong>, и дополнительная аутентификация не требуется.</li>
<li>При вызове методов API из внешней системы в запросы необходимо добавлять заголовки для аутентификации с использованием аккаунта, которому предоставлен доступ к API.</li>
<li>Большинство внешних систем обладают интерфейсом настройки метода аутентификации, при отсутствии такового добавьте в <code>Header</code> запроса параметр <code>Authorization</code>, содержащий зашифрованные в формате <code>Base64</code> имя пользователь и пароль.</li>
</ul>
</div>
<h3 id="инициация-запроса-к-внешней-системе">Инициация запроса к внешней системе</h3>
<p><strong>REST API</strong> широко применяется в современных системах, и зачастую найти документацию по использованию API конкретной системы можно, введя в поисковой системе запрос вида <em>«&lt;название системы&gt; REST API»</em>.</p>
<p><strong>Comindware Platform</strong> поддерживает перечисленные ниже способы обращения к API внешних систем:</p>
<ul>
<li>Запрос отправляет скрипт на C# (вызываемый <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4790">кнопкой</a> или <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4728">задачей выполнения сценария</a> в процессе). Скрипт устанавливает подключение к внешней системе, формирует запрос, отправляет его и получает ответ.</li>
<li>Запрос формирует и отправляет <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4717">сценарий</a> посредством настроенного подключения к внешней системе. Сценарий позволяет сформировать тело запроса, проанализировать полученный ответ и поместить из него данные в атрибуты записей.</li>
<li>Запрос формирует и отправляет <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4740">промежуточное</a> или <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4745">конечное событие</a> отправки сообщения в процессе.</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Для отправки запросов с помощью сценариев и событий процесса требуется настроить <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4675">подключение</a> к внешней службе и <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4676">путь передачи данных</a>. </p>
</div>
<h3 id="аутентификация-при-доступе-к-api-внешних-систем">Аутентификация при доступе к API внешних систем</h3>
<p>При доступе из к внешним API используйте метод аутентификации, который поддерживает внешняя система. Обратитесь документации API этой системы, чтобы узнать, следует ли указывать имя пользователя b пароль в URL-адресе или теле запроса, или необходимо сгенерировать и использовать токен безопасности вместо передачи пароля в виде обычного текста.</p>
<h2 id="использование-swagger">Использование Swagger</h2>
<p><strong>Comindware Platform</strong> предоставляет встроенный веб-интерфейс API на основе Swagger.</p>
<ul>
<li>Swagger предоставляет подробную справку по методам API, включая описания запросов и ответов, а также модели данных с примерами значений.</li>
<li>Swagger позволяет выполнять запросы и просматривать ответы.</li>
<li>При выполнении запроса Swagger формирует URI ресурса API для использования во внешних системах, включая синтаксис тела запроса.</li>
</ul>
<ol class="colored_numbers_list">
<li>Чтобы перейти к странице Swagger, введите в адресной строке браузера строку <code>https://your-host/docs</code>, где <code>your-host</code> — доменное имя вашего сервера.</li>
<li>
<p>Отобразится страница <strong>Comindware Platform API</strong> со следующими разделами:</p>
<ul>
<li><strong>RESTful Web API</strong> — общие методы для всех версий ПО (см. <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4861">Методы Web API</a>);</li>
<li><strong>System Core API</strong> — системные методы, которые могут отличаться для разных версий ПО (см. <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4862">Методы System Core API</a>);</li>
<li><strong>Solution API</strong> — методы для шаблонов бизнес-приложений (см. <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4863">Методы Solution API</a>).</li>
</ul>
</li>
<li>
<p>Перейдите на страницу требуемого API.</p>
</li>
<li>Раскройте требуемый метод API в списке.</li>
<li>Выберите формат запроса и ответа в поле <strong>Response Content Type</strong>.</li>
<li>Запустите любой из доступных методов, нажав кнопку <strong>Try it out</strong>.</li>
<li>
<p>Отобразится заготовка запроса:</p>
<ul>
<li><strong>Request URL</strong> — скопируйте эту строку во внешнюю систему в качестве URI запроса, для запросов <code>GET</code> и <code>DELETE</code> она содержит весь запрос;</li>
<li><strong>Example Value</strong> — скопируйте эту строку во внешнюю систему в качестве тела запроса.</li>
</ul>
</li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Страница Swagger UI с разделами API Comindware Platform" src="https://kb.comindware.ru/assets/img_661d06c21de49.png"/><figcaption class="caption">Страница Swagger UI с разделами API Comindware Platform</figcaption></p>
</figure>
<h2 id="пример-вызова-метода-system-core-api">Пример вызова метода System Core API</h2>
<p>Для создания шаблона записи с помощью System Core API отправьте следующий <code>POST</code>-запрос на адрес <strong>Request URL</strong>, указанный в Swagger:</p>
<div class="highlight"><code><pre><span></span><code>http://your-host/api/public/system/TeamNetwork/ObjectAppService/Create</code> <br/></pre></code></div>
<ul>
<li>Вместо <code>your-host</code> укажите адрес экземпляра <strong>Comindware Platform</strong>.</li>
<li>В теле запроса (<code>body</code>) укажите системное имя шаблона записи (например, <code>"Car"</code>).</li>
<li>В ответ на запрос <strong>Comindware Platform</strong> вернёт ID созданного шаблона записи (например, <code>"oa.1"</code>).</li>
</ul>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4863">Методы Solution API</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4862">Методы System Core API</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4861">Методы Web API</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4674">Ключи аутентификации</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4662">Системные роли. Определения, настройка, объединение, удаление</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>