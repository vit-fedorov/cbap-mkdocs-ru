<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="5002" kb-tags="" kb-title="Атрибут типа «Документ». Скачивание файлов в папку на сервере">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#образец-скрипта">
<span class="md-ellipsis">
      Образец скрипта
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>Здесь представлен C#-скрипт для <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4790">кнопки</a></strong>, который сохраняет все файлы, прикреплённые к атрибуту типа «<strong>Документ</strong>», из текущей записи в локальную папку <strong>на сервере Comindware Platform</strong>.</p>
<div class="notice notice-success">
<p class="admonition-title">Структура атрибута типа «Документ»</p>
<ul>
<li>Атрибут типа «<strong>Документ</strong>» хранит одну или несколько ссылок на записи (<strong>документы</strong>) в системном шаблоне документа, к которым прикрепляются файлы (например, загруженные пользователями).</li>
<li>В шаблоне документа имеется атрибут <code>currentRevision</code> (текущая <strong>версия</strong>), который хранит ссылку на запись в системном шаблоне версии.</li>
<li>В шаблоне версии имеются атрибуты <code>title</code> (имя) и <code>content</code> (содержимое), которые хранят имя файла и ссылку на файл, физически хранящийся в папке <code>Streams</code> на сервере.</li>
</ul>
</div>
<div class="notice notice-tip">
<p class="admonition-title">Извлечение файлов из атрибута типа «Документ» с помощью C#</p>
<p>Чтобы считать файл из атрибута типа «<strong>Документ</strong>» с помощью C#-скрипта, необходимо:</p>
<ul>
<li>
<p>из текущей записи получить массив идентификаторов файлов, прикреплённых к атрибуту:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">fileIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">ObjectService</span><span class="p">.</span><span class="n">GetPropertyValues</span><span class="p">(</span><span class="n">recordId</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="s">"documentAttributeSystemName"</span><span class="p">})</span><span class="err">`</span><span class="p">;</span></code> <br/></pre></code></div>
</li>
<li>
<p>получить массив объектов с прикреплёнными файлами:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">attachedFileObjects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fileIds</span><span class="p">[</span><span class="n">docId</span><span class="p">].</span><span class="n">TryGetValue</span><span class="p">(</span><span class="s">"Files"</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="n">fileObject</span><span class="p">)</span><span class="w"> </span></code> <br/><code><span class="w">                            </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">fileObject</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">fileObject</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">object</span><span class="p">[]</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">null</span><span class="p">;</span></code> <br/></pre></code></div>
</li>
<li>
<p>получить объект файла (<code>attachedFile</code>):</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">attachedFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">DocumentService</span><span class="p">.</span><span class="n">GetContent</span><span class="p">(</span><span class="n">attachedFileObject</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">());</span></code> <br/></pre></code></div>
</li>
<li>
<p>получить имя файла с расширением (<code>attachedFile.Name</code>);</p>
</li>
<li>получить содержимое файла (<code>attachedFile.Data</code>);</li>
<li>
<p>при необходимости получить объект с метаданными документа:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">attachedFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">DocumentService</span><span class="p">.</span><span class="n">GetDocument</span><span class="p">(</span><span class="n">attachedFileObject</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">());</span></code> <br/></pre></code></div>
<ul>
<li><code>attachedFile.Title</code> — имя файла с расширением;</li>
<li><code>attachedFile.Extension</code> — расширение файла.</li>
</ul>
</li>
</ul>
</div>
<div class="notice notice-tip">
<p class="admonition-title">Добавление файлов в атрибут типа «Документ» с помощью C#</p>
<p>Чтобы прикрепить к атрибуту типа «<strong>Документ</strong>» файл с помощью C#-скрипта, необходимо:</p>
<ul>
<li>
<p>сформировать объект типа <code>Document</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Document</span><span class="w"> </span></code> <br/><code><span class="w">    </span><span class="p">{</span></code> <br/><code><span class="w">        </span><span class="n">Title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"имя файла.расширение"</span><span class="p">,</span></code> <br/><code><span class="w">        </span><span class="n">Extension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">".расширение"</span></code> <br/><code><span class="w">    </span><span class="p">};</span></code> <br/></pre></code></div>
</li>
<li>
<p>сформировать массив байтов <code>byte[] fileBytes</code> с содержимым файла;</p>
</li>
<li>
<p>из массива байтов создать поток <code>MemoryStream()</code> для прикрепления документа к атрибуту:</p>
<div class="highlight"><code><pre><span></span><code><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">fileStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">();</span></code> <br/><code><span class="w">    </span><span class="n">fileStream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">fileBytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">fileBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span></code> <br/><code><span class="w">    </span><span class="n">fileStream</span><span class="p">.</span><span class="n">Seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SeekOrigin</span><span class="p">.</span><span class="n">Begin</span><span class="p">);</span></code> <br/></pre></code></div>
</li>
<li>
<p>преобразовать поток в объект документа для прикрепления к атрибуту:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">string</span><span class="w"> </span><span class="n">documentObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">DocumentService</span><span class="p">.</span><span class="n">CreateDocumentWithStream</span><span class="p">(</span><span class="n">document</span><span class="p">,</span><span class="w"> </span><span class="n">fileStream</span><span class="p">,</span><span class="w"> </span><span class="s">""</span><span class="p">);</span></code> <br/></pre></code></div>
</li>
<li>
<p>сформировать словарь из системного имени атрибута и объекта документа:</p>
<div class="highlight"><code><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">documentDict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dictionary</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">object</span><span class="o">&gt;</span></code> <br/><code><span class="w">    </span><span class="p">{</span></code> <br/><code><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="s">"DocumentAttributeSystemName"</span><span class="p">,</span><span class="w"> </span><span class="n">documentObject</span><span class="w"> </span><span class="p">}</span></code> <br/><code><span class="w">    </span><span class="p">};</span></code> <br/></pre></code></div>
</li>
<li>
<p>прикрепить результирующий документ к атрибуту записи <code>reсordId</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="w">    </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">ObjectService</span><span class="p">.</span><span class="n">EditWithAlias</span><span class="p">(</span><span class="n">reсordId</span><span class="p">,</span><span class="w"> </span><span class="n">documentDict</span><span class="p">)</span></code> <br/></pre></code></div>
</li>
</ul>
</div>
<h2 class="pageBreakBefore" id="образец-скрипта">Образец скрипта</h2>
<div class="highlight"><span class="filename">Скрипт для скачивания файлов на сервер</span><code><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">System.Collections.Generic</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">System.Linq</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.Data.Entity</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data.UserCommands</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data</span><span class="p">;</span></code> <br/><code><span class="k">using</span><span class="w"> </span><span class="nn">System.IO</span><span class="p">;</span></code> <br/><code><span class="k">class</span><span class="w"> </span><span class="nc">Script</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="n">UserCommandContext</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">,</span><span class="w"> </span><span class="n">Comindware</span><span class="p">.</span><span class="n">Entities</span><span class="w"> </span><span class="n">entities</span><span class="p">)</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">            </span><span class="c1">//&lt;ServerDownloadPath&gt; — путь для скачивания файлов на сервере</span></code> <br/><code><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="s">"&lt;ServerDownloadPath&gt;"</span><span class="p">;</span></code> <br/><code><span class="w">            </span><span class="c1">//DocumentAttributeSystemName — системное имя атрибута типа «Документ»</span></code> <br/><code><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">ObjectService</span><span class="p">.</span><span class="n">GetPropertyValues</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                </span><span class="n">userCommandContext</span><span class="p">.</span><span class="n">ObjectIds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code> <br/><code><span class="w">            </span><span class="p">},</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                </span><span class="s">"DocumentAttributeSystemName"</span></code> <br/><code><span class="w">            </span><span class="p">});</span></code> <br/><code><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">documentIdsObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">userCommandContext</span><span class="p">.</span><span class="n">ObjectIds</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s">"DocumentAttributeSystemName"</span><span class="p">];</span></code> <br/><code><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">documentIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">documentIdsObj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">IEnumerable</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">;</span></code> <br/><code><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">documentIds</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                </span><span class="n">documentIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                    </span><span class="n">documentIdsObj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">string</span></code> <br/><code><span class="w">                </span><span class="p">};</span></code> <br/><code><span class="w">            </span><span class="p">}</span></code> <br/><code><span class="w">            </span><span class="k">foreach</span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">documentIdObj</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">documentIds</span><span class="p">)</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">documentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">documentIdObj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">documentData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">DocumentService</span><span class="p">.</span><span class="n">GetContent</span><span class="p">(</span><span class="n">documentId</span><span class="p">);</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">documentInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Api</span><span class="p">.</span><span class="n">TeamNetwork</span><span class="p">.</span><span class="n">DocumentService</span><span class="p">.</span><span class="n">GetDocument</span><span class="p">(</span><span class="n">documentId</span><span class="p">);</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">docData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Document</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                    </span><span class="n">Title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">documentData</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span></code> <br/><code><span class="w">                        </span><span class="n">Extension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">documentInfo</span><span class="p">.</span><span class="n">Extension</span></code> <br/><code><span class="w">                </span><span class="p">};</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">();</span></code> <br/><code><span class="w">                </span><span class="n">stream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">documentData</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">documentData</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span></code> <br/><code><span class="w">                </span><span class="n">stream</span><span class="p">.</span><span class="n">Seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SeekOrigin</span><span class="p">.</span><span class="n">Begin</span><span class="p">);</span></code> <br/><code><span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">documentData</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span></code> <br/><code><span class="w">                </span><span class="n">using</span><span class="p">(</span><span class="n">FileStream</span><span class="w"> </span><span class="n">outstr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileStream</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="w"> </span><span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">))</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                    </span><span class="n">stream</span><span class="p">.</span><span class="n">CopyTo</span><span class="p">(</span><span class="n">outstr</span><span class="p">);</span></code> <br/><code><span class="w">                </span><span class="p">}</span></code> <br/><code><span class="w">            </span><span class="p">}</span></code> <br/><code><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">badresult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                </span><span class="n">Success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code> <br/><code><span class="w">                    </span><span class="n">Commited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code> <br/><code><span class="w">                    </span><span class="n">ResultType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserCommandResultType</span><span class="p">.</span><span class="n">DataChange</span><span class="p">,</span></code> <br/><code><span class="w">                    </span><span class="n">Messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandMessage</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                            </span><span class="n">Severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeverityLevel</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span></code> <br/><code><span class="w">                                </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Неудачно"</span></code> <br/><code><span class="w">                        </span><span class="p">}</span></code> <br/><code><span class="w">                    </span><span class="p">}</span></code> <br/><code><span class="w">            </span><span class="p">};</span></code> <br/><code><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">badresult</span><span class="p">;</span></code> <br/><code><span class="w">        </span><span class="p">}</span></code> <br/><code></code> <br/><code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">            </span><span class="n">Success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code> <br/><code><span class="w">                </span><span class="n">Commited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code> <br/><code><span class="w">                </span><span class="n">ResultType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserCommandResultType</span><span class="p">.</span><span class="n">DataChange</span><span class="p">,</span></code> <br/><code><span class="w">                </span><span class="n">Messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandMessage</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">                        </span><span class="n">Severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeverityLevel</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span></code> <br/><code><span class="w">                            </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Удачно"</span></code> <br/><code><span class="w">                    </span><span class="p">}</span></code> <br/><code><span class="w">                </span><span class="p">}</span></code> <br/><code><span class="w">        </span><span class="p">};</span></code> <br/><code><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span></code> <br/><code><span class="w">    </span><span class="p">}</span></code> <br/><code><span class="p">}</span></code> <br/></pre></code></div>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4782">Атрибут типа «Документ»</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4790">Кнопки. Определение, настройка, удаление</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4864">Написание скриптов на языке C#</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=5081">Атрибут типа «Документ». Скачивание архива с файлами из всех строк таблицы с прикреплением архива к атрибуту</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4921">Атрибут типа «Документ». Скачивание архива с файлами из выбранных строк таблицы и записи</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4883">Атрибут типа «Документ». Клонирование записи вместе с прикреплёнными файлами</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>