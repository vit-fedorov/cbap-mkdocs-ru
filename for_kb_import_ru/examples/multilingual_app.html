<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="5064">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#прикладная-задача">
<span class="md-ellipsis">
      Прикладная задача
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-шаблона-записи-тип-автомобиля">
<span class="md-ellipsis">
      Настройка шаблона записи «Тип автомобиля»
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-шаблона-записи-заявки-на-автомобили">
<span class="md-ellipsis">
      Настройка шаблона записи «Заявки на автомобили»
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-групп-ролей-и-раздела-навигации">
<span class="md-ellipsis">
      Настройка групп, ролей и раздела навигации
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#настройка-кнопки-переключения-языка">
<span class="md-ellipsis">
      Настройка кнопки переключения языка
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#тестирование">
<span class="md-ellipsis">
      Тестирование
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p><strong>Comindware Platform</strong> позволяет создать интерфейс приложения на различных языках. Можно настроить отображаемые названия форм, полей, кнопок и пунктов навигации на разных языках, а также дать пользователем возможность переключаться между доступными языками.</p>
<p>Здесь представлена инструкция по настройке шаблонов записи для отображения интерфейса на русском и английском языках, а также кнопки для смены языка интерфейса.</p>
<h2 id="прикладная-задача">Прикладная задача</h2>
<p>Имеется приложение <em>«Управление автопарком»</em>.</p>
<p>Требуется настроить шаблон <em>«Заявки на автомобили»</em>, связанный с ним шаблон <em>«Тип автомобиля»</em>, форму <em>«Заявка на автомобиль»</em> и раздел навигации <em>«Управление автопарком»</em>, которые будут поддерживать отображение на русском и английском языках.</p>
<p>Формы <em>«Заявка на автомобиль»</em> и раздел навигации <em>«Управление автопарком»</em> должны отображаться на языке, заданном в аккаунте текущего пользователя.</p>
<p>Также требуется настроить кнопку смены языка отображения интерфейса приложения и языка в аккаунте текущего пользователя.</p>
<div class="notice notice-warning">
<p class="admonition-title">Логика работы многоязычного интерфейса</p>
<ul>
<li>Для переключения языка отображения форм и навигации мы используем:<ul>
<li>отдельные формы и разделы навигации на английском и русском языках;</li>
<li>правила для форм, скрывающие и показывающие формы в соответствии с языком пользователя;</li>
<li>специальные группы и роли для пользователей, использующих приложение на английском и русском языках;</li>
<li>шаблон аккаунта, служащий для смены языка в аккаунтах пользователей;</li>
<li>две кнопки, которые будут менять язык отображения приложения.</li>
</ul>
</li>
<li>Формы и разделы навигации на английском языке будут скрыты для пользователей, у которых в аккаунте задан русский язык. И наоборот, для пользователей с английским языком будут отображаться английские формы и разделы навигации.</li>
<li>При входе пользователя приложение будет отображаться на языке, указанном в его аккаунте, и для него будет отображаться раздел навигации, назначенный роли с соответствующим языком.</li>
<li>Для пользователя будет отображаться одна из кнопок смены языка — на английский в русском интерфейсе и на русский — в английском.</li>
<li>При нажатии кнопки смены языка пользователь будет перемещён в группу с требуемым языком, при этом будет изменён язык в его аккаунте. Формы станут отображаться на заданном языке. В результате смены группы пользователю будет назначена новая роль с разделом навигации на требуемом языке.</li>
<li>Для отображения приложения на новом языке пользователь должен обновить страницу в веб-браузере.</li>
</ul>
</div>
<h2 id="настройка-шаблона-записи-тип-автомобиля">Настройка шаблона записи «Тип автомобиля»</h2>
<ol class="colored_numbers_list">
<li>Создайте шаблон записи <em>«Тип автомобиля»</em>.</li>
<li>
<p>Создайте атрибуты:</p>
<table style="width: 100%;">
<thead>
<tr>
<th>Название</th>
<th>Системное имя</th>
<th>Тип данных</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Название RU</em></td>
<td><code>NameRU</code></td>
<td><strong>Текст</strong></td>
</tr>
<tr>
<td><em>Название EN</em></td>
<td><code>NameEN</code></td>
<td><strong>Текст</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Добавьте атрибут <em>«Отображаемое название»</em>:</p>
<ul>
<li><strong>Тип данных: текст</strong></li>
<li><strong>Использовать как заголовок записей:</strong> флажок установлен</li>
<li><strong>Вычислять автоматически:</strong> флажок установлен</li>
<li><strong>Вычисляемое выражение: формула</strong></li>
</ul>
<div class="highlight"><code><pre><span></span><code><span class="n">IF</span><span class="w"> </span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="o">==</span><span class="err">'</span><span class="n">ru</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="n">VALUE</span><span class="p">(</span><span class="err">$</span><span class="n">NameRU</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">NameEN</span><span class="p">),</span><span class="w"> </span><span class="n">VALUE</span><span class="p">(</span><span class="err">$</span><span class="n">NameEN</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">NameRU</span><span class="p">))</span></code><br/>
</pre></code></div>
</li>
<li>
<p>Поместите созданные атрибуты на форму шаблона <em>«Тип автомобиля»</em>.</p>
</li>
<li>
<p>Создайте записи со следующими значениями:</p>
<table style="width: 100%;">
<thead>
<tr>
<th><em>Название RU</em></th>
<th><em>Название EN</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>легковой</em></td>
<td><em>car</em></td>
</tr>
<tr>
<td><em>автобус</em></td>
<td><em>bus</em></td>
</tr>
<tr>
<td><em>грузовой</em></td>
<td><em>truck</em></td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="настройка-шаблона-записи-заявки-на-автомобили">Настройка шаблона записи «Заявки на автомобили»</h2>
<div class="notice notice-tip">
<p class="admonition-title">Названия полей на разных языках</p>
<p>Для удобства настройки одинаковых форм и разделов навигации на разных языках задавайте унифицированные названия шаблонов и атрибутов на требуемых языках через <code>/</code>, например <em>«Номер заявки / Request Number»</em>.</p>
<p>При настройке полей на формах и разделов навигации для каждого языка оставьте только соответствующие отображаемые названия.</p>
<p>Например, для поля <em>«Номер заявки / Request Number»</em> на английской форме в отображаемом названии удалите часть <em>«Номер заявки /»</em> и оставьте текст <em>«Request Number»</em>, а на русской форме наоборот — <em>«Номер заявки»</em>.</p>
</div>
<ol class="colored_numbers_list">
<li>Создайте шаблон записи <em>«Заявки на автомобили / Vehicle requests»</em>.</li>
<li>Создайте атрибуты <em>«Номер заявки / Request Number»</em> и <em>«Количество пассажиров / Amount of passengers»</em> типа «<strong>Число</strong>».</li>
<li>Создайте атрибут <em>«Тип автомобиля / Vehicle Type»</em> типа «<strong>Запись</strong>», связанный с шаблоном <em>«Тип автомобиля»</em>.</li>
<li>Создайте форму <em>«Форма на русском»</em> и поместите на неё атрибуты.</li>
<li>Отредактируйте отображаемые названия полей, оставив только русский текст.</li>
<li>Сохраните форму.</li>
<li>Создайте форму <em>«Форма на английском»</em> и поместите на неё атрибуты.</li>
<li>Отредактируйте отображаемые названия полей, оставив только английский текст.</li>
<li>Сохраните форму.</li>
<li>Откройте для редактирования форму <em>«Заявки на автомобили / Vehicle requests — Основная форма»</em></li>
<li>Поместите на основную форму <em>форму на русском</em> и <em>форму на английском</em>.</li>
<li>Создайте <strong>правило</strong> для основной формы.</li>
<li>
<p>Добавьте в правило для формы следующее <strong>действие</strong>:</p>
<ul>
<li><strong>Элемент формы:</strong> <em>Форма на русском</em></li>
<li><strong>Действие: изменить доступ</strong></li>
<li><strong>Новое значение: скрыть</strong></li>
<li><strong>Условие выполнения: формула</strong></li>
</ul>
<div class="highlight"><code><pre><span></span><code><span class="n">EQUALS</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">,</span><span class="s">"en"</span><span class="p">)</span></code><br/>
</pre></code></div>
<p>Это действие будет скрывать <em>форму на русском</em> для пользователей, у которых в аккаунте задан английский язык.</p>
</li>
<li>
<p>Добавьте в правило для формы следующее <strong>действие</strong>:</p>
<ul>
<li><strong>Элемент формы:</strong> <em>Форма на английском</em></li>
<li><strong>Действие: изменить доступ</strong></li>
<li><strong>Новое значение: скрыть</strong></li>
<li><strong>Условие выполнения: формула</strong></li>
</ul>
<div class="highlight"><code><pre><span></span><code><span class="n">OR</span><span class="p">(</span><span class="n">EQUALS</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">,</span><span class="s">"ru"</span><span class="p">),</span><span class="n">EMPTY</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">))</span></code><br/>
</pre></code></div>
<p>Это действие будет скрывать <em>форму на английском</em> для пользователей, у которых в аккаунте задан русский язык или язык не задан.</p>
</li>
<li>
<p>Сохраните форму.</p>
</li>
</ol>
<h2 id="настройка-групп-ролей-и-раздела-навигации">Настройка групп, ролей и раздела навигации</h2>
<ol class="colored_numbers_list">
<li>Создайте группу <em>«Пользователи RU»</em> и добавьте в неё аккаунты пользователей, которые будут использовать приложение на русском языке.</li>
<li>Создайте роль <em>«Пользователь RU»</em> и добавьте в неё группу <em>«Пользователи RU»</em>.</li>
<li>Настройте права доступа для роли согласно логике работы приложения.</li>
<li>Создайте группу <em>«Пользователи EN»</em> и добавьте в неё аккаунты, которые будут использовать приложение на английском языке.</li>
<li>Создайте роль <em>«Пользователь EN»</em> и добавьте в неё группу <em>«Пользователи EN»</em>.</li>
<li>Настройте права доступа для роли.</li>
<li>Создайте раздел навигации <em>«Управление автопарком»</em> и назначьте его роли <em>«Пользователь RU»</em>.</li>
<li>Добавьте в этот раздел навигации шаблон записи <em>«Заявки на автомобили / Vehicle requests»</em> и смените название пункта на <em>«Заявки на автомобили»</em>.</li>
<li>Создайте раздел навигации <em>«Fleet management»</em> и назначьте его роли <em>«Пользователь EN»</em>.</li>
<li>Добавьте в этот раздел навигации шаблон записи <em>«Заявки на автомобили / Vehicle requests»</em> и смените название пункта на <em>«Vehicle requests»</em>.</li>
</ol>
<h2 id="настройка-кнопки-переключения-языка">Настройка кнопки переключения языка</h2>
<ol class="colored_numbers_list">
<li>Создайте шаблон аккаунта <em>«Пользователи»</em>.</li>
<li>Перейдите на вкладку «<strong>Кнопки</strong>».</li>
<li>
<p>Создайте кнопку <em>«Switch to English»</em> со следующими свойствами:</p>
<ul>
<li><strong>Контекст операции: аккаунт</strong></li>
<li><strong>Операция: C#-скрипт</strong></li>
<li><strong>Результат выполнения: обновить данные</strong></li>
</ul>
</li>
<li>
<p>На вкладке «<strong>Скрипт</strong>» введите C#-скрипт по следующему образцу:</p>
<div class="highlight"><code><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span><span class="w"> </span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">System.Collections.Generic</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">System.Linq</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.Data.Entity</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data.UserCommands</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.Data</span><span class="p">;</span></code><br/>
<code><span class="k">class</span><span class="w"> </span><span class="nc">Script</span></code><br/>
<code><span class="p">{</span></code><br/>
<code><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="n">UserCommandContext</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">,</span><span class="w"> </span><span class="n">Comindware</span><span class="p">.</span><span class="n">Entities</span><span class="w"> </span><span class="n">entities</span><span class="p">)</span></code><br/>
<code><span class="w">    </span><span class="p">{</span><span class="w"> </span></code><br/>
<code><span class="w">        </span><span class="c1">// Получаем ID аккаунта текущего пользователя.</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">.</span><span class="n">ObjectIds</span><span class="p">[</span><span class="m">0</span><span class="p">];</span></code><br/>
<code><span class="w">        </span><span class="c1">// Исключаем аккаунт из группы «Пользователи RU» с ID group.1.</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountGroupService</span><span class="p">.</span><span class="n">ExcludeMembers</span><span class="p">(</span><span class="w"> </span><span class="s">"group.1"</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(){</span><span class="n">id</span><span class="p">});</span></code><br/>
<code><span class="w">        </span><span class="c1">// Включаем аккаунт в группу «Пользователи EN» с ID group.2.</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountGroupService</span><span class="p">.</span><span class="n">IncludeMembers</span><span class="p">(</span><span class="w"> </span><span class="s">"group.2"</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(){</span><span class="n">id</span><span class="p">});</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountService</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">id</span><span class="p">);</span></code><br/>
<code><span class="w">        </span><span class="c1">// Задаём код языка en в аккаунте пользователя.</span></code><br/>
<code><span class="w">        </span><span class="n">account</span><span class="p">.</span><span class="n">Language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"en"</span><span class="p">;</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountService</span><span class="p">.</span><span class="n">Edit</span><span class="p">(</span><span class="n">account</span><span class="p">);</span></code><br/>
<code><span class="w">        </span><span class="c1">// Возвращаем объект с результатом нажатия кнопки</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandResult</span></code><br/>
<code><span class="w">        </span><span class="p">{</span></code><br/>
<code><span class="w">            </span><span class="n">Success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">Commited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">ResultType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserCommandResultType</span><span class="p">.</span><span class="n">Notificate</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">Messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">[]</span></code><br/>
<code><span class="w">            </span><span class="p">{</span></code><br/>
<code><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandMessage</span></code><br/>
<code><span class="w">                </span><span class="p">{</span></code><br/>
<code><span class="w">                    </span><span class="n">Severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeverityLevel</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span></code><br/>
<code><span class="w">                    </span><span class="c1">// Выводим всплывающее уведомление о смене языка на английский.</span></code><br/>
<code><span class="w">                    </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Language changed to English."</span></code><br/>
<code><span class="w">                    </span><span class="p">}</span></code><br/>
<code><span class="w">            </span><span class="p">}</span></code><br/>
<code><span class="w">        </span><span class="p">};</span></code><br/>
<code><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span></code><br/>
<code><span class="w">    </span><span class="p">}</span></code><br/>
<code><span class="p">}</span></code><br/>
</pre></code></div>
</li>
<li>
<p>На вкладке «<strong>Условия отображения</strong>» добавьте формулу:</p>
<div class="highlight"><code><pre><span></span><code><span class="n">OR</span><span class="p">(</span><span class="n">EQUALS</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">,</span><span class="s">"ru"</span><span class="p">),</span><span class="n">EMPTY</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">))</span></code><br/>
</pre></code></div>
<p>Кнопка <em>«Switch to English»</em> будет отображаться для пользователей, у которых в аккаунте задан русский язык или язык не задан.</p>
</li>
<li>
<p>Сохраните кнопку.</p>
</li>
<li>
<p>Создайте кнопку <em>«Переключить на русский»</em> со следующими свойствами:</p>
<ul>
<li><strong>Контекст операции: аккаунт</strong></li>
<li><strong>Операция: C#-скрипт</strong></li>
<li><strong>Результат выполнения: обновить данные</strong></li>
</ul>
</li>
<li>
<p>На вкладке «<strong>Скрипт</strong>» добавьте C#-скрипт по следующему образцу:</p>
<div class="highlight"><code><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span><span class="w"> </span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">System.Collections.Generic</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">System.Linq</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.Data.Entity</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data.UserCommands</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.TeamNetwork.Api.Data</span><span class="p">;</span></code><br/>
<code><span class="k">using</span><span class="w"> </span><span class="nn">Comindware.Data</span><span class="p">;</span></code><br/>
<code><span class="k">class</span><span class="w"> </span><span class="nc">Script</span></code><br/>
<code><span class="p">{</span></code><br/>
<code><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="n">UserCommandContext</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">,</span><span class="w"> </span><span class="n">Comindware</span><span class="p">.</span><span class="n">Entities</span><span class="w"> </span><span class="n">entities</span><span class="p">)</span></code><br/>
<code><span class="w">    </span><span class="p">{</span><span class="w"> </span></code><br/>
<code><span class="w">        </span><span class="c1">// Получаем ID аккаунта текущего пользователя.</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">.</span><span class="n">ObjectIds</span><span class="p">[</span><span class="m">0</span><span class="p">];</span></code><br/>
<code><span class="w">        </span><span class="c1">// Исключаем аккаунт из группы «Пользователи EN» с ID group.2.</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountGroupService</span><span class="p">.</span><span class="n">ExcludeMembers</span><span class="p">(</span><span class="w"> </span><span class="s">"group.2"</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(){</span><span class="n">id</span><span class="p">});</span></code><br/>
<code><span class="w">        </span><span class="c1">// Включаем аккаунт в группу «Пользователи RU» с ID group.1.</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountGroupService</span><span class="p">.</span><span class="n">IncludeMembers</span><span class="p">(</span><span class="w"> </span><span class="s">"group.1"</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(){</span><span class="n">id</span><span class="p">});</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountService</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">id</span><span class="p">);</span></code><br/>
<code><span class="w">        </span><span class="c1">// Устанавливаем код языка ru в аккаунте пользователя.</span></code><br/>
<code><span class="w">        </span><span class="n">account</span><span class="p">.</span><span class="n">Language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ru"</span><span class="p">;</span></code><br/>
<code><span class="w">        </span><span class="n">Api</span><span class="p">.</span><span class="n">Base</span><span class="p">.</span><span class="n">AccountService</span><span class="p">.</span><span class="n">Edit</span><span class="p">(</span><span class="n">account</span><span class="p">);</span></code><br/>
<code><span class="w">        </span><span class="c1">// Возвращаем объект с результатом нажатия кнопки</span></code><br/>
<code><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandResult</span></code><br/>
<code><span class="w">        </span><span class="p">{</span></code><br/>
<code><span class="w">            </span><span class="n">Success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">Commited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">ResultType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserCommandResultType</span><span class="p">.</span><span class="n">Notificate</span><span class="p">,</span></code><br/>
<code><span class="w">            </span><span class="n">Messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">[]</span></code><br/>
<code><span class="w">            </span><span class="p">{</span></code><br/>
<code><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">UserCommandMessage</span></code><br/>
<code><span class="w">                </span><span class="p">{</span></code><br/>
<code><span class="w">                    </span><span class="n">Severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeverityLevel</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span></code><br/>
<code><span class="w">                    </span><span class="c1">// Выводим всплывающее уведомление о смене языка на русский.</span></code><br/>
<code><span class="w">                    </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Язык изменён на русский."</span></code><br/>
<code><span class="w">                    </span><span class="p">}</span></code><br/>
<code><span class="w">            </span><span class="p">}</span></code><br/>
<code><span class="w">        </span><span class="p">};</span></code><br/>
<code><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span></code><br/>
<code><span class="w">    </span><span class="p">}</span></code><br/>
<code><span class="p">}</span></code><br/>
</pre></code></div>
</li>
<li>
<p>На вкладке «<strong>Условия отображения</strong>» добавьте формулу:</p>
<div class="highlight"><code><pre><span></span><code><span class="n">EQUALS</span><span class="p">(</span><span class="n">USER</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">language</span><span class="p">,</span><span class="s">"en"</span><span class="p">)</span><span class="w"> </span></code><br/>
</pre></code></div>
<p>Кнопка <em>«Переключить на русский»</em> будет отображаться для пользователей, у которых в аккаунте задан английский язык.</p>
</li>
<li>
<p>Сохраните кнопку.</p>
</li>
<li>Поместите обе кнопки на форму шаблона <em>«Пользователи»</em>.</li>
<li>Привяжите к шаблону <em>«Пользователи»</em> аккаунты, ранее добавленные в группы <em>«Пользователи RU»</em> и <em>«Пользователи EN»</em>.</li>
</ol>
<h2 id="тестирование">Тестирование</h2>
<ol class="colored_numbers_list">
<li>Войдите в <strong>Comindware Platform</strong> используя аккаунт, у которого задан русский язык и который входит в группу <em>«Пользователи RU»</em>.</li>
<li>Приложение и раздел навигации должны отображаться на русском языке.</li>
<li>Создайте запись в шаблоне <em>«Заявки на автомобили / Vehicle requests»</em>.</li>
<li>Форма и данные атрибута <em>«Тип автомобиля / Vehicle Type»</em> должны отобразиться на русском языке.</li>
<li>Перейдите к шаблону <em>«Пользователи»</em> и нажмите кнопку «<strong>Перейти к экземплярам</strong>».</li>
<li>Откройте свой аккаунт в списке.</li>
<li>Нажмите кнопку <em>«Switch to English»</em>.</li>
<li>Вместо кнопки <em>«Switch to English»</em> должна отобразиться кнопка <em>«Переключить на русский»</em>.</li>
<li>Приложение должно отобразиться на английском языке. Если смена языка не произошла, обновите страницу в браузере.</li>
<li>Перейдите к записи шаблона <em>«Заявки на автомобиль / Vehicle requests»</em>.</li>
<li>Форма и данные атрибута <em>«Тип автомобиля / Vehicle Type»</em> должны отображаться на английском языке.</li>
</ol>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4993">Список функций языка формул Comindware</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4864">Написание скриптов на языке C#</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>