---
title: Интеграция с 1С по OData. Настройка для импорта данных
kbId: 2011
---

# Интеграция с 1С по OData. Настройка для импорта данных

## Введение

В **Comindware** **Business** **Application** **Platform** можно настраивать интеграции с внешними службами посредством OData без помощи разработчиков — силами аналитика. Для этого достаточно настроить подключение к внешней службе и сопоставление атрибутов между приложением и внешней службой.

После настройки интеграции синхронизацию данных между приложением и внешней службой можно запускать как вручную, так и автоматически.

В этой статье представлен пример настройки интеграции с 1С.

## Настройка подключения

1. Создайте новое [подключение для **синхронизации с веб-сервисом**][odata_connection].
2. Настройте свойства подключения:

    - **Название** — наглядное наименование подключения, например *1С*.
    - **Тип исходящего подключения**— **OData**.
    - **Адрес веб-сервиса** — введите URL-адрес OData-сервера 1C.
    - **Тип аутентификации** — **Обычная**.
        - **Имя пользователя** — введите логин для подключения к OData-серверу 1C.
        - **Пароль** — введите пароль для подключения к OData-серверу 1C.
    - **Версия** **OData** — выберите версию протокола OData, которую поддерживает OData-сервер 1C, например V3.
    - **Заголовок**— при необходимости введите заголовки HTTP-запроса к OData-серверу 1C.
3. Нажмите кнопку «**Проверить соединение**».
4. В случае успешного соединения в области «**Результаты**» отобразится список справочников из базы данных 1С. В случае неуспешного соединения — сообщение «**Произошла ошибка**». В таком случае проверьте правильность введенных данных и наличие прав на доступ к службе 1С у пользователя, под которым настраиваете аутентификацию.
5. Сохраните подключение.   

_![Настройка подключения к OData-сервису](https://kb.comindware.ru/assets/3.1_2021-12-16_183857.png)_

## Настройка интеграции

1. Откройте приложение, в котором будете настраивать интеграцию
2. Выберите пункт «**Интеграции**». 

_![Расположение раздела «Интеграции»](https://kb.comindware.ru/assets/3.2_2021-12-20_162559.png)_
3. Нажмите кнопку «**Создать**».
4. Отобразится окно свойств интеграции.
5. Настройте параметры на вкладке «**Основные настройки**»: 
    - **Название**— введите наглядное название интеграции, например *«Номенклатурные объекты»*.
    - **Подключение по****OData** — выберите ранее созданное подключение для синхронизации с веб-сервисом, например *«1С»*.
    - **Тип**— **Импорт**.
    - **Шаблон записи** — шаблон записи, в который будут импортироваться данные, например *«(1С) Номенклатура. Объекты»*.
    - **Внешняя сущность** — источник данных, из которого будут импортироваться данные в шаблон, например *«Catalog\_Номенклатура»*.
    - **Какие объекты синхронизировать** — **Все**.
    - **Тип запуска** — **Вручную**.
    - **Преобразование атрибутов** — настройте сопоставление атрибутов между **шаблоном записи** и **внешней сущностью**:
        - **Внутренние данные** — укажите атрибуты шаблона записи, в которые будут записываться импортируемые данные;
        - **Внешние данные** — укажите атрибут **внешней сущности**, из которых будут импортироваться данные (в нашем примере это поля справочника *«Catalog\_Номенклатура»*);
        - **Ключевое свойство** — укажите пару атрибутов, являющихся первичными ключами (primary\_key). Если при импорте записи совпадут значения этих атрибутов в имеющейся записи в шаблоне и в импортируемой записи, то запись в шаблоне будет обновлена импортируемыми данными. В противном случае в шаблоне будет создана новая запись с импортированными данными.
        
        ![Настройка основных свойств интеграции в приложении](https://kb.comindware.ru/assets/3.3_2021-12-20_143746.png)
        
        
        Настройка основных свойств интеграции в приложении
6. Настройте параметры вкладку «**Настройки импорта**». Заполните следующие данные: 
    - **Зависит от** — выберите другую интеграцию, синхронизацию по которой необходимо запускать перед текущей интеграцией. В нашем примере выбрана интеграция *«Единица изм.»*, потому что в записях в шаблоне *«(1С) Номенклатура. Объекты»*указаны единицы измерения и их необходимо актуализировать перед импортом данных.
    - **Добавить новую настройку постпроцессинга** — нажмите эту кнопку, чтобы настроить устанавливать значения в атрибутах типа «**Запись**» посредством сопоставления значений ключевых атрибутов в импортируемых записях и связанных записях.
    - **Целевой атрибут**— выберите атрибут типа «**Запись**» к которому требуется привязать имеющиеся записи из связанного шаблона, например «*Ед.Изм.*».
    - **Атрибут в выбранном шаблоне** — выберите атрибут из шаблона записи, связанного с атрибутом *«Ед.изм.»*, в котором хранятся уникальные значения, с которыми будут сравниваться значения **атрибута в ссылочном шаблоне**;
    - **Атрибут в ссылочном шаблоне**— выберите атрибут из шаблона «*1С\_Номенклатуры.Объекты*», в который будут импортироваться уникальные идентификаторы единиц измерения из базы данных 1C.
    
    Логика постпроцессинга
    
    
    Постпроцессинг позволяет привязать импортируемые записи к имеющимся записям в связанном шаблоне.
    
    
    В таблице «**Преобразование атрибутов**» необходимо выбрать ключевые атрибуты связанных шаблонов записи, содержащие уникальные идентификаторы записей, которые требуется связать между собой посредством **целевого атрибута**.
    
    
    Эти значения будут сравниваться при импорте записей. Если значения ключевых атрибутов в импортируемой записи и в имеющейся записи связанного шаблона совпадут, то эти записи будут связаны посредством выбранного **целевого атрибута**.
    
    
    
    
    ![Настройки импорта данных из 1C](https://kb.comindware.ru/assets/3.4_2021-12-20_153936.png)
    
    
    Настройки импорта данных из 1C
7. Сохраните интеграцию.
8. В списке интеграций установите флажок выбора у настроенной интеграции и нажмите «**Запуск синхронизации**».
9. Затем перейдите в журналы, откройте таблицу «**Интеграция по OData**».
10. При неудачных интеграциях ознакомьтесь с логами для более детальной информации об ошибках.

_![Журнал сеансов интеграции по OData](https://kb.comindware.ru/assets/2022-02-15_09h13_27.png)_

--8<-- "related_topics_heading.md"

**[Синхронизация с веб-сервисом. Настройка подключения][odata_connection]**

**[Синхронизация с веб-сервисом. Интеграция по OData][odata_integration]**

**[Журналы событий][logs]**



 

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
