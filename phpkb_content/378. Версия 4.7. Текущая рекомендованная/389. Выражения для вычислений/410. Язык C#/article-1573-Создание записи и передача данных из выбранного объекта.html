<h1>Создание записи и передача данных из выбранного объекта</h1><p>Для того, чтобы по кнопке можно было по выбранному объекту/ам создать запись в каком-либо Шаблоне записи и передать туда какие-либо данные, введите следующее выражение:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code"> 
<p>using System;<br/>using System.IO;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using Comindware.Data.Entity;<br/>using Comindware.TeamNetwork.Api.Data.UserCommands;</p>
<p>public class Script<br/>{<br/>    public static UserCommandResult Main(UserCommandContext userCommandContext, Comindware.Entities entities)<br/>    {<br/>        var currentObjectid = userCommandContext.ObjectIds;<br/>        foreach(var id in currentObjectid)<br/>        {<br/>            var request = Api.TeamNetwork.ObjectService.Get(id);<br/>            object descriptionObject;<br/>            request.TryGetValue("op.93", out descriptionObject);<br/>            object name;<br/>            request.TryGetValue("op.92", out name);<br/>            var propertyDictionary = new Dictionary&lt;string, object&gt;();<br/>            propertyDictionary.Add("Description", descriptionObject);<br/>            propertyDictionary.Add("title", name);<br/>            Api.TeamNetwork.ObjectService.CreateWithAlias("Issue", propertyDictionary);<br/>        }<br/>                var result = new UserCommandResult<br/>        {<br/>            Success = true,<br/>            Commited = true,<br/>            ResultType = UserCommandResultType.DataChange,<br/>            Messages = new[]<br/>            {<br/>                new UserCommandMessage<br/>                {<br/>                    Severity = SeverityLevel.Normal,<br/>                    Text = "Успешно"<br/>                }<br/>            }<br/>        };<br/>        return result;<br/>    }<br/>}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><span style="text-decoration: underline;"><strong>где:</strong></span></p>
<p><strong>op.93</strong> - ИД атрибута в текущем Шаблоне записи, чьё значение нужно передать в новую запись;</p>
<p><span style="color: #333333; font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 100; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;"><strong>op.92</strong> - ИД атрибута в текущем Шаблоне записи, чьё значение нужно передать в новую запись;</span></p>
<p><strong>Issue</strong> - системное имя Шаблона записи, где будут создаваться новые записи;</p>
<p><strong>Description</strong> - системное имя атрибута в Шаблоне записи Issue, в который будет передаваться значение из op.93;</p>
<p><strong>title</strong> <span style="color: #333333; font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 100; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">- системное имя атрибута в Шаблоне записи Issue, в который будет передаваться значение из op.92;</span></p><h1>Создание записи и передача данных из выбранного объекта</h1><p>Для того, чтобы по кнопке можно было по выбранному объекту/ам создать запись в каком-либо Шаблоне записи и передать туда какие-либо данные, введите следующее выражение:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code"> 
<p>using System;<br/>using System.IO;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using Comindware.Data.Entity;<br/>using Comindware.TeamNetwork.Api.Data.UserCommands;</p>
<p>public class Script<br/>{<br/>    public static UserCommandResult Main(UserCommandContext userCommandContext, Comindware.Entities entities)<br/>    {<br/>        var currentObjectid = userCommandContext.ObjectIds;<br/>        foreach(var id in currentObjectid)<br/>        {<br/>            var request = Api.TeamNetwork.ObjectService.Get(id);<br/>            object descriptionObject;<br/>            request.TryGetValue("op.93", out descriptionObject);<br/>            object name;<br/>            request.TryGetValue("op.92", out name);<br/>            var propertyDictionary = new Dictionary&lt;string, object&gt;();<br/>            propertyDictionary.Add("Description", descriptionObject);<br/>            propertyDictionary.Add("title", name);<br/>            Api.TeamNetwork.ObjectService.CreateWithAlias("Issue", propertyDictionary);<br/>        }<br/>                var result = new UserCommandResult<br/>        {<br/>            Success = true,<br/>            Commited = true,<br/>            ResultType = UserCommandResultType.DataChange,<br/>            Messages = new[]<br/>            {<br/>                new UserCommandMessage<br/>                {<br/>                    Severity = SeverityLevel.Normal,<br/>                    Text = "Успешно"<br/>                }<br/>            }<br/>        };<br/>        return result;<br/>    }<br/>}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><span style="text-decoration: underline;"><strong>где:</strong></span></p>
<p><strong>op.93</strong> - ИД атрибута в текущем Шаблоне записи, чьё значение нужно передать в новую запись;</p>
<p><span style="color: #333333; font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 100; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;"><strong>op.92</strong> - ИД атрибута в текущем Шаблоне записи, чьё значение нужно передать в новую запись;</span></p>
<p><strong>Issue</strong> - системное имя Шаблона записи, где будут создаваться новые записи;</p>
<p><strong>Description</strong> - системное имя атрибута в Шаблоне записи Issue, в который будет передаваться значение из op.93;</p>
<p><strong>title</strong> <span style="color: #333333; font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 100; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">- системное имя атрибута в Шаблоне записи Issue, в который будет передаваться значение из op.92;</span></p>