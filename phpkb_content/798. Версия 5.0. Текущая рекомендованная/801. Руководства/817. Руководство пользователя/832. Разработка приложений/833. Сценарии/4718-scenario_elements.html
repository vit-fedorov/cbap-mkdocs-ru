<h1>Событие и действия сценария. Определения, типы, свойства, настройка</h1><div class="md-container" data-md-component="container">
<div class="md-main__inner md-grid"><nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">Содержание</h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#введение"> <span class="md-ellipsis"> Введение </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_event"> <span class="md-ellipsis"> Событие сценария </span> </a><nav aria-label="Событие сценария" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_event_common_properties"> <span class="md-ellipsis"> Общие свойства событий </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#свойства-событий-по-типам"> <span class="md-ellipsis"> Свойства событий по типам </span> </a><nav aria-label="Свойства событий по типам" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#нажатие-кнопки"> <span class="md-ellipsis"> Нажатие кнопки </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#создание-записи"> <span class="md-ellipsis"> Создание записи </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#изменение-записи"> <span class="md-ellipsis"> Изменение записи </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#запуск-процесса"> <span class="md-ellipsis"> Запуск процесса </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#получение-сообщения"> <span class="md-ellipsis"> Получение сообщения </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#вход-токена"> <span class="md-ellipsis"> Вход токена </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#выход-токена"> <span class="md-ellipsis"> Выход токена </span> </a></li>
</ul>
</nav></li>
</ul>
</nav></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_actions"> <span class="md-ellipsis"> Действия сценария </span> </a><nav aria-label="Действия сценария" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_actions_common_properties"> <span class="md-ellipsis"> Общие свойства действий </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#свойства-действий-по-типам"> <span class="md-ellipsis"> Свойства действий по типам </span> </a><nav aria-label="Свойства действий по типам" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#создать-запись"> <span class="md-ellipsis"> Создать запись </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#дублировать-запись"> <span class="md-ellipsis"> Дублировать запись </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#сменить-контекст"> <span class="md-ellipsis"> Сменить контекст </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#изменить-значения-атрибутов"> <span class="md-ellipsis"> Изменить значения атрибутов </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#создать-документ-по-шаблону"> <span class="md-ellipsis"> Создать документ по шаблону </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#прикрепить-документ-к-атрибуту"> <span class="md-ellipsis"> Прикрепить документ к атрибуту </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_actions_validate_expression"> <span class="md-ellipsis"> Проверить результат выражения </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_actions_validate_csharp"> <span class="md-ellipsis"> Проверить результат скрипта </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#выполнить-по-условиям"> <span class="md-ellipsis"> Выполнить по условиям </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#повторять-по-числовому-счётчику"> <span class="md-ellipsis"> Повторять по числовому счётчику </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#повторять-по-количеству-объектов"> <span class="md-ellipsis"> Повторять по количеству объектов </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#запустить-процесс"> <span class="md-ellipsis"> Запустить процесс </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#scenario_actions_send_message"> <span class="md-ellipsis"> Отправить сообщение </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#изменить-значения-переменных"> <span class="md-ellipsis"> Изменить значения переменных </span> </a></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#изменить-значения-скриптом"> <span class="md-ellipsis"> Изменить значения скриптом </span> </a></li>
</ul>
</nav></li>
</ul>
</nav></li>
<li class="md-nav__item"><a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи"> <span class="md-ellipsis"> Связанные статьи </span> </a></li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>Сценарий состоит из события, которое запускает его, и последовательности действий, которые выполняются согласно настроенной логике.</p>
<p>Здесь представлены сведения о настройке <strong><a class="mkdocs_imported_link" href="#scenario_event">событий</a></strong> и <strong><a class="mkdocs_imported_link" href="#scenario_actions">действий</a></strong> сценариев.</p>
<h2 id="scenario_event">Событие сценария</h2>
<div class="notice notice-success">
<p class="admonition-title">Определения</p>
<p><strong>Событие</strong> — это элемент, наступление которого запускает сценарий.</p>
<p>Все остальные элементы сценария следуют за его событием.</p>
<p>Предусмотрены следующие события сценария:</p>
<ul>
<li><strong><a class="mkdocs_imported_link" href="#нажатие-кнопки">Нажатие кнопки</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#создание-записи">Создание записи</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#изменение-записи">Изменение записи</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#запуск-процесса">Запуск процесса</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#получение-сообщения">Получение сообщения</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#вход-токена">Вход токена</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#выход-токена">Выход токена</a></strong></li>
</ul>
<p>У события можно настроить <a class="mkdocs_imported_link" href="#scenario_event_common_properties">общие</a> и <a class="mkdocs_imported_link" href="#свойства-событий-по-типам">специфические для каждого типа</a> свойства.</p>
</div>
<h3 id="scenario_event_common_properties">Общие свойства событий</h3>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>При создании нового сценария в приложении автоматически формируется ненастроенное событие «<strong>Нажата кнопка</strong>», после чего следует выбрать требуемый тип события и настроить его.</p>
<p>При создании сценариев на входе и выходе из элементов диаграммы процесса автоматически настраиваются событие «<strong>Вход токена</strong>» или «<strong>Выход токена</strong>» соответственно и необходимое действие «<strong>Сменить контекст</strong>».</p>
</div>
<p>Для события любого типа можно настроить следующие свойства:</p>
<ul>
<li><strong>Описание</strong> — наглядный комментарий о назначении события.</li>
<li><strong>Тип</strong> — тип события, запускающего сценарий.</li>
<li><strong>Контекстный шаблон</strong> — шаблон записи или процесса, в контексте которого будет выполняться сценарий.</li>
</ul>
<div class="notice notice-success">
<p class="admonition-title">Контекст выполнения действий</p>
<p><strong>Контекстный шаблон</strong> определяет контекст выполнения действий сценария, то есть набор атрибутов, которые будут доступны для манипуляций с помощью действий.</p>
<p>По умолчанию действия выполняются в контексте шаблона, заданного в событии сценария.</p>
<p>Контекстный шаблон может меняться внутри действий «<a class="mkdocs_imported_link" href="#создать-запись"><strong>Создать запись</strong></a>», «<a class="mkdocs_imported_link" href="#создать-запись"><strong>Дублировать запись</strong></a>» и «<a class="mkdocs_imported_link" href="#сменить-контекст"><strong>Сменить контекст</strong></a>». При выходе из этих действий восстанавливается исходный контекст, заданный в событии сценария.</p>
</div>
<figure class="screenshot_with_caption">
<p><img alt="Настройка свойств события «Нажатие кнопки»" src="https://kb.comindware.ru/assets/scenario_event_properties.png"/></p>
<figcaption class="caption">Настройка свойств события «Нажатие кнопки»</figcaption>
</figure>
<h3 id="свойства-событий-по-типам">Свойства событий по типам</h3>
<h4 id="нажатие-кнопки">Нажатие кнопки</h4>
<p>Сценарий будет запускаться при нажатии указанной <strong>кнопки</strong> в <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстном шаблоне</a></strong>.</p>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Сценарий по событию «<strong>Нажатие кнопки</strong>» может быть запущен при нажатии любой кнопки, кроме кнопки с операцией «<strong>Создать</strong>», так как для «<a class="mkdocs_imported_link" href="#создание-записи"><strong>создания записи</strong></a>» предусмотрено специальное событие.</p>
</div>
<h4 id="создание-записи">Создание записи</h4>
<p>Сценарий будет запускаться при создании записи в <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстном шаблоне</a></strong>.</p>
<h4 id="изменение-записи">Изменение записи</h4>
<p>Сценарий будет запускаться при изменении значений указанных <strong>атрибутов</strong> любой записи в <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстном шаблоне</a></strong>.</p>
<p>Если <strong>атрибуты</strong> не указаны, то сценарий будет запускаться при изменении значения любого атрибута любой записи в <strong>контекстном шаблоне</strong>.</p>
<h4 id="запуск-процесса">Запуск процесса</h4>
<p>Сценарий будет запускаться при создании экземпляра <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона процесса</a></strong>.</p>
<h4 id="получение-сообщения">Получение сообщения</h4>
<p>Сценарий будет запускаться при получении сообщения через указанные подключение и путь передачи данных.</p>
<ul>
<li><strong>Подключение</strong> — подключение для получения сообщений, инициирующих запуск сценария.</li>
<li><strong>Путь передачи данных</strong> — путь передачи данных для обработки сообщений.</li>
<li><strong>Имя переменной</strong> — переменная, в которую будет помещено содержимое сообщения, обработанное посредством пути передачи данных.</li>
</ul>
<h4 id="вход-токена">Вход токена</h4>
<p>Сценарий будет запускаться перед выполнением элемента диаграммы <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона процесса</a></strong>.</p>
<p>Это событие и необходимое после него действие «<a class="mkdocs_imported_link" href="#сменить-контекст"><strong>Сменить контекст</strong></a>» настраиваются автоматически при создании сценария на входе в <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4724"><strong>элемент диаграммы</strong> процесса</a>.</p>
<p><strong>Тип</strong>, <strong>контекстный шаблон</strong> и <strong>элемент диаграммы</strong> этого события не следует менять во избежание ошибок при выполнении сценария.</p>
<p>Чтобы настроить сценарий на входе в другой элемент диаграммы, воспользуйтесь <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4721#mcetoc_1h28cr6421">меню элемента</a> в конструкторе диаграммы процесса.</p>
<h4 id="выход-токена">Выход токена</h4>
<p>Сценарий будет запускаться после выполнения выбранного элемента диаграммы <strong><a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона процесса</a></strong>.</p>
<p>Это событие и необходимое после него действие «<a class="mkdocs_imported_link" href="#сменить-контекст"><strong>Сменить контекст</strong></a>» настраиваются автоматически при создании сценария на выходе из <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4724"><strong>элемента диаграммы</strong> процесса</a>.</p>
<p><strong>Тип</strong>, <strong>контекстный шаблон</strong> и <strong>элемент диаграммы</strong> этого события не следует менять во избежание ошибок при выполнении сценария.</p>
<p>Чтобы настроить сценарий на выходе из другого элемента диаграммы, воспользуйтесь <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4721#mcetoc_1h28cr6421">меню элемента</a> в конструкторе диаграммы процесса.</p>
<h2 id="scenario_actions">Действия сценария</h2>
<div class="notice notice-success">
<p class="admonition-title">Определения</p>
<p><strong>Действие сценария</strong> — это элемент, который выполняется после наступления <strong>события сценария</strong>.</p>
<p>Действия сценария служат для обработки и передачи данных, организации циклов и условного выполнения других действий.</p>
<p>Сценарий может содержать произвольное количество действий, выполняющихся согласно настроенной бизнес-логике.</p>
<p>Некоторые действия могут содержать вложенные действия, задавать их логику выполнения и менять <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстный шаблон</a>.</p>
<p>Предусмотрены следующие действия сценария:</p>
<ul>
<li><strong><a class="mkdocs_imported_link" href="#создать-запись">Создать запись</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#дублировать-запись">Дублировать запись</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#сменить-контекст">Сменить контекст</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#изменить-значения-атрибутов">Изменить значения атрибутов</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#изменить-значения-переменных">Изменить значения переменных</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#изменить-значения-скриптом">Изменить значения скриптом</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#создать-документ-по-шаблону">Создать документ по шаблону</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#прикрепить-документ-к-атрибуту">Прикрепить документ к атрибуту</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#запустить-процесс">Запустить процесс</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#scenario_actions_send_message">Отправить сообщение</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#scenario_actions_validate_expression">Проверить результат выражения</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#scenario_actions_validate_csharp">Проверить результат скрипта</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#выполнить-по-условиям">Выполнить по условиям</a></strong>;</li>
<li><strong><a class="mkdocs_imported_link" href="#повторять-по-числовому-счётчику">Повторять по числовому счётчику</a></strong></li>
<li><strong><a class="mkdocs_imported_link" href="#повторять-по-количеству-объектов">Повторять по количеству объектов</a></strong></li>
</ul>
<p>У действий можно настроить <a class="mkdocs_imported_link" href="#scenario_actions_common_properties">общие</a> и <a class="mkdocs_imported_link" href="#свойства-действий-по-типам">специфические для каждого типа</a> свойства.</p>
</div>
<h3 id="scenario_actions_common_properties">Общие свойства действий</h3>
<p>Для действия любого можно настроить следующие свойства:</p>
<ul>
<li>Вкладка «<strong>Основные</strong>»
<ul>
<li><strong>Описание</strong> — наглядный комментарий о назначении действия.</li>
</ul>
</li>
<li>Вкладка «<strong>Дополнительно</strong>»
<ul>
<li><strong>Тип</strong> — тип действия. Его можно сменить, но рекомендуется создавать новое действие требуемого типа во избежание ошибок при выполнении сценария.</li>
<li><strong>Контекстный шаблон</strong> — шаблон, в контексте которого будет выполняться действие. <a class="mkdocs_imported_link" href="#scenario_event_common_properties">Контекст</a> для действий сценария задаётся в <strong>событии сценария</strong>, а также в действиях «<strong>Создать запись</strong>», «<strong>Дублировать запись</strong>» и «<strong>Сменить контекст</strong>».</li>
<li><strong>Игнорировать все ошибки</strong> — если установлен этот флажок, данное действие сценария будет выполняться несмотря на любые ошибки: исключения, недопустимые данные и т. п.</li>
<li><strong>Выполнять отдельно от сценария</strong> — если установлен этот флажок, данное действие и все вложенные в него действия будут выполняться асинхронно с последующими действиями в сценарии.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка общих свойств действия на вкладке «Дополнительно»" src="https://kb.comindware.ru/assets/scenario_actions_common_properties.png"/></p>
<figcaption class="caption">Настройка общих свойств действия на вкладке «Дополнительно»</figcaption>
</figure>
<h3 id="свойства-действий-по-типам">Свойства действий по типам</h3>
<h4 id="создать-запись">Создать запись</h4>
<p>Это действие создаёт запись в указанном шаблоне. Контекст вложенных действий меняется на целевой шаблон.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Целевой шаблон записи</strong> — шаблон, в котором будет создана запись.</li>
<li><strong>Ссылка на новую запись</strong> — атрибут типа «<strong>Запись</strong>» <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»), в который будет помещена ссылка на созданную запись. Это поле можно задать, если контекстный шаблон связан с целевым шаблоном.</li>
<li><strong>Операция со значениями</strong> — доступно, если выбрана ссылка на новую запись:
<ul>
<li><strong>Добавить</strong> — добавление ссылки на созданную запись в указанный атрибут (если для него установлен флажок «<strong>Хранить несколько записей</strong>»).</li>
<li><strong>Заменить</strong> — замена имеющихся ссылок в указанном атрибуте ссылкой на созданную запись.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Создать запись»" src="https://kb.comindware.ru/assets/scenario_actions_create_record.png"/></p>
<figcaption class="caption">Настройка действия «Создать запись»</figcaption>
</figure>
<h4 id="дублировать-запись">Дублировать запись</h4>
<p>Это действие дублирует указанные записи. Контекст вложенных действий меняется на дублированные записи в целевом шаблоне, и вложенные действия выполняются для каждой дублированной записи.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Целевой шаблон записи</strong> — шаблон, в котором будут созданы дубликаты записей. Должен совпадать с шаблоном, записи из которого возвращает <strong>атрибут или выражение для поиска объектов</strong>.</li>
<li><strong>Ссылка на новую запись</strong> — атрибут типа «<strong>Запись</strong>» <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»), в который будет помещена ссылка на дублированную запись. Это поле можно задать, если контекстный шаблон связан с целевым шаблоном записи.</li>
<li><strong>Атрибут или выражение для поиска объектов</strong> — атрибут типа «<strong>Запись</strong>», ссылающийся на дублируемые записи, или выражение (<strong>формулу</strong>, <strong>N3</strong> или <strong>DMN</strong>), возвращающее идентификаторы дублируемых записей.</li>
<li><strong>Операция со значениями</strong> — доступно, если выбрана ссылка на новую запись:
<ul>
<li><strong>Добавить</strong> — добавление ссылки на созданную запись в указанный атрибут (если у него установлен флажок «<strong>Хранить несколько значений</strong>»).</li>
<li><strong>Заменить</strong> — замена имеющихся ссылок в указанном атрибуте ссылкой на созданную запись.</li>
</ul>
</li>
<li><strong>Дублировать дочерние записи</strong> — установите этот флажок, чтобы дублировать запись вместе с записями, на которые она ссылается. При этом дублироваться будут только те дочерние записи, на которые ссылаются атрибуты с установленным флажком «<strong>Удалять связанные записи</strong>».
<ul>
<li><strong>Глубина дублирования</strong> — количество уровней дочерних записей, подлежащих дублированию.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Дублировать запись»" src="https://kb.comindware.ru/assets/scenario_actions_clone_record.png"/></p>
<figcaption class="caption">Настройка действия «Дублировать запись»</figcaption>
</figure>
<h4 id="сменить-контекст">Сменить контекст</h4>
<p>Это действие меняет контекст выполнения вложенных действий на указанные записи в целевом шаблоне. То есть вложенные действия выполняются для каждой записи, которую возвращает <strong>атрибут или выражение для поиска объектов</strong>.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Целевой шаблон записи</strong> — шаблон записи, на который следует сменить контекст выполнения сценария. Должен совпадать с шаблоном, записи из которого возвращает <strong>атрибут или выражение для поиска объектов</strong>.</li>
<li><strong>Атрибут или выражение для поиска объектов</strong> — выберите атрибут типа «<strong>Запись</strong>» или введите выражение (<strong>формулу</strong>, <strong>N3</strong> или <strong>DMN</strong>), возвращающее идентификатор одной или нескольких записей, по которым требуется выполнить вложенные действия.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Сменить контекст»" src="https://kb.comindware.ru/assets/scenario_actions_change_context.png"/></p>
<figcaption class="caption">Настройка действия «Сменить контекст»</figcaption>
</figure>
<h4 id="изменить-значения-атрибутов">Изменить значения атрибутов</h4>
<p>Это действие изменяет значения указанных атрибутов в записи <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»).</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Создать</strong> — нажмите, чтобы добавить атрибут и настроить изменение его значения.</li>
<li><strong>Удалить</strong> — нажмите, чтобы убрать выбранный атрибут.</li>
<li><strong>Атрибут</strong> — подлежащий изменению атрибут <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»).</li>
<li><strong>Операция со значениями</strong>
<ul>
<li><strong>Заменить</strong> — установка в атрибуте значения, указанного в столбце «<strong>Значение</strong>».</li>
<li><strong>Удалить</strong> — удаление всех значений из атрибута.</li>
<li><strong>Добавить</strong> — добавление в атрибут значения, указанного в столбце «<strong>Значение</strong>» (этот пункт отображается для атрибутов типа «<strong>Запись</strong>», «<strong>Аккаунт</strong>», «<strong>Роль</strong>», «<strong>Организационная единица</strong>», «<strong>Документ</strong>», «<strong>Изображение</strong>» с установленным флажком «<strong>Хранить несколько значений</strong>»).</li>
<li><strong>Исключить</strong> — удаление из атрибута ссылок на объекты, указанные в столбце «<strong>Значение</strong>» (этот пункт отображается для атрибутов типа «<strong>Запись</strong>», «<strong>Аккаунт</strong>», «<strong>Роль</strong>», «<strong>Организационная единица</strong>»,  «<strong>Документ</strong>», «<strong>Изображение</strong>» с установленным флажком «<strong>Хранить несколько значений</strong>»). Сами связанные объекты при этом удалены не будут.</li>
</ul>
</li>
<li><strong>Значение</strong> — задайте одно или несколько значений атрибута посредством другого <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Изменить значения атрибутов»" src="https://kb.comindware.ru/assets/scenario_actions_change_attribute_values.png"/></p>
<figcaption class="caption">Настройка действия «Изменить значения атрибутов»</figcaption>
</figure>
<h4 id="создать-документ-по-шаблону">Создать документ по шаблону</h4>
<p>Это действие формирует файл посредством <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4797">шаблона экспорта</a> и помещает ссылку на него в переменную. Затем созданный файл следует поместить в атрибут типа «<strong>Документ</strong>» с помощью действия «<a class="mkdocs_imported_link" href="#прикрепить-документ-к-атрибуту"><strong>Прикрепить документ к атрибуту</strong></a>».</p>
<p>Настройте действие:</p>
<ul>
<li>
<p><strong>Поместить документ в переменную</strong></p>
<ul>
<li><strong>Операция со значением переменной</strong>
<ul>
<li><strong>Добавить</strong> — добавление ссылки на сформированный файл в переменную.</li>
<li><strong>Заменить</strong> — замена значения в переменной ссылкой на сформированный файл.</li>
<li><strong>Удалить</strong> — обнуление значения переменной.</li>
</ul>
</li>
<li><strong>Переменная</strong> — укажите имя переменной, в которую будет помещена ссылка на сформированный файл.</li>
</ul>
<figure class="screenshot_with_caption"><img alt="Настройка переменной для действия «Создать документ по шаблону»" src="https://kb.comindware.ru/assets/scenario_actions_create_document_variable.png"/>
<figcaption class="caption">Настройка переменной для действия «Создать документ по шаблону»</figcaption>
</figure>
</li>
<li>
<p><strong>Шаблон экспорта</strong> — настройте шаблон экспорта для формирования и заполнения файла значениями атрибута из <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»).</p>
<ul>
<li><strong>Создать</strong> — настройте новый шаблон экспорта:
<ul>
<li><strong>Название</strong> — наглядное название шаблона экспорта.</li>
<li><strong>Системное имя</strong> — уникальное имя шаблона экспорта, формируется автоматически из названия шаблона.</li>
<li><strong>Файл шаблона</strong> — загрузите файл шаблона экспорта (выбрав пункт «<strong>Значение</strong>»), выберите <strong>атрибут</strong> с типом данных «<strong>Документ</strong>», содержащий файл шаблона экспорта, либо задайте такой атрибут с помощью <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
<li><strong>Имя выходного файла</strong> — задайте имя сформированного файла (без расширения; расширение будет совпадать с расширением файла шаблона экспорта) с помощью <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
<li><strong>Экспортировать как PDF</strong> — установите этот флажок, чтобы сформировать файл в формате PDF.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption"><img alt="Создание нового шаблона экспорта для действия «Создать документ по шаблону»" src="https://kb.comindware.ru/assets/scenario_actions_create_document_using_new_template.png"/>
<figcaption class="caption">Создание нового шаблона экспорта для действия «Создать документ по шаблону»</figcaption>
</figure>
<ul>
<li><strong>Выбрать существующий</strong>
<ul>
<li><strong>Выберите шаблон экспорта</strong> — укажите шаблон экспорта из <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»), по которому будет создан и заполнен файл.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption"><img alt="Выбор имеющегося шаблона экспорта для действия «Создать документ по шаблону»" src="https://kb.comindware.ru/assets/scenario_actions_create_document_using_existing_template.png"/>
<figcaption class="caption">Выбор имеющегося шаблона экспорта для действия «Создать документ по шаблону»</figcaption>
</figure>
</li>
</ul>
<h4 id="прикрепить-документ-к-атрибуту">Прикрепить документ к атрибуту</h4>
<p>Это действие помещает в атрибуты типа «<strong>Документ</strong>» ссылки на файлы, сформированные с помощью действий «<a class="mkdocs_imported_link" href="#создать-документ-по-шаблону"><strong>Создать документ по шаблону</strong></a>».</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Создать</strong> — нажмите, чтобы добавить атрибут и настроить прикрепление к нему файла.</li>
<li><strong>Удалить</strong> — нажмите, чтобы убрать выбранные атрибуты.</li>
<li><strong>Атрибут</strong> — атрибут типа «<strong>Документ</strong>», в который будут помещена ссылка на файл, указанная в столбце «<strong>Значение</strong>».</li>
<li><strong>Операция со значениями</strong>
<ul>
<li><strong>Добавить</strong> — добавление ссылки на файл в атрибут, у которого установлен флажок «<strong>Хранить несколько значений</strong>».</li>
<li><strong>Заменить</strong> — замена всех ссылок на файлы в атрибуте ссылкой, указанной в столбце «<strong>Значение</strong>» (при этом сами файлы заменены не будут).</li>
<li><strong>Создать</strong> — создание в атрибуте новой ссылки на файл.</li>
</ul>
</li>
<li><strong>Значение</strong> — укажите переменную из действия «<a class="mkdocs_imported_link" href="#создать-документ-по-шаблону"><strong>Создать документ по шаблону</strong></a>», в которой хранится прикрепляемый файл.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Прикрепить документ к атрибуту»" src="https://kb.comindware.ru/assets/scenario_actions_attach_document_to_attribute.png"/></p>
<figcaption class="caption">Настройка действия «Прикрепить документ к атрибуту»</figcaption>
</figure>
<h4 id="scenario_actions_validate_expression">Проверить результат выражения</h4>
<p>Это действие проверяет выполнение заданного условия.</p>
<p>Выражение должно возвращать логическое значение <code>true</code> или <code>false</code>. Любое значение кроме логического <code>true</code> будет считаться значением <code>false</code>.</p>
<p>Если выражение вернёт <code>false</code>, сценарий будет остановлен и все его действия будут отменены, как если бы он не запускался. При этом будет выведено сообщение об ошибке с заданным текстом:</p>
<ul>
<li>Для сценария по любым событиям, кроме входа и выхода токена, сообщение об ошибке отобразится во всплывающем уведомлении в браузере, в <strong>журнале действий и ошибок</strong> <em class="fal fa-flag">‌<!--icon--></em> на информационной панели и в <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4673">журналах событий</a></strong> на вкладке «<strong>Операции</strong>».</li>
<li>Для сценария на входе или выходе токена сообщение об ошибке отобразится в цепочке событий, которую можно просмотреть следующим образом:
<ul>
<li>Перейдите к диаграмме экземпляра процесса.</li>
<li>Откройте <strong>журнал изменений</strong>.</li>
<li>Нажмите значок <em class="fa-light fa-circle-exclamation">‌<!--icon--></em> рядом с названием сценария.</li>
<li>Отобразится цепочка событий.</li>
<li>Справа от цепочки событий в пункте «<strong>Уведомления</strong>» отобразится сообщение об ошибке.</li>
</ul>
</li>
</ul>
<p>С помощью этого действия можно осуществлять отладку сценариев и, например, устанавливать запрет на сохранение записей. См. <em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4929">«Отладка формул, выражений N3, сценариев и C#-скриптов»</a></em> и <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4919"><em>«Сценарий. Запрет сохранения записи»</em></a>.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Сообщение об ошибке</strong> — текст, который отобразится во всплывающем сообщении, в журнале действий и ошибок и в цепочке событий, если выражение вернёт значение <code>false</code>.</li>
<li><strong>Выражение</strong> — условие проверки (<strong>атрибут</strong>, <strong>формула</strong>, <strong>N3</strong> или <strong>DMN</strong>). Действие сработает, если выражение вернёт значение <code>false</code>.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Проверить результат выражения»" src="https://kb.comindware.ru/assets/scenario_actions_validate_expression_result.png"/></p>
<figcaption class="caption">Настройка действия «Проверить результат выражения»</figcaption>
</figure>
<figure class="screenshot_with_caption">
<p><img alt="Пример сообщения действия «Проверить результат выражения» в цепочке событий" src="https://kb.comindware.ru/assets/scenario_verify_expression_csharp_event_chain_message.png"/></p>
<figcaption class="caption">Пример сообщения действия «Проверить результат выражения» в цепочке событий</figcaption>
</figure>
<h4 id="scenario_actions_validate_csharp">Проверить результат скрипта</h4>
<p>Это действие проверяет выполнение заданного C#-скрипта.</p>
<p>Скрипт должен возвращать логическое значение значение <code>true</code> или <code>false</code>. Любое значение кроме логического <code>true</code> будет считаться значением <code>false</code>.</p>
<p>Если скрипт вернёт <code>false</code>, сценарий будет остановлен и все его действия будут отменены, как если бы он не запускался. При этом будет выведено сообщение об ошибке с заданным текстом:</p>
<ul>
<li>Для сценария по любым событиям, кроме входа и выхода токена, сообщение об ошибке отобразится во всплывающем уведомлении в браузере, в <strong>журнале действий и ошибок</strong> <em class="fal fa-flag">‌<!--icon--></em> на информационной панели и в <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4673">журналах событий</a></strong> на вкладке «<strong>Операции</strong>».</li>
<li>Для сценария на входе или выходе токена сообщение об ошибке отобразится в цепочке событий, которую можно просмотреть следующим образом:
<ul>
<li>Перейдите к диаграмме экземпляра процесса.</li>
<li>Откройте <strong>журнал изменений</strong>.</li>
<li>Нажмите значок <em class="fa-light fa-circle-exclamation">‌<!--icon--></em> рядом с названием сценария.</li>
<li>Отобразится цепочка событий.</li>
<li>Справа от цепочки событий в пункте «<strong>Уведомления</strong>» отобразится сообщение об ошибке.</li>
</ul>
</li>
</ul>
<p>Настройте действие:</p>
<ul>
<li><strong>Сообщение об ошибке</strong> —  текст, который отобразится во всплывающем сообщении, в журнале действий и ошибок и в цепочке событий, если скрипт вернёт значение <code>false</code>.</li>
<li><strong>Выражение</strong> — C#-скрипт, выполняющий проверку. Действие сработает, если скрипт вернёт значение <code>false</code>. Любое значение кроме <code>true</code> типа <code>bool</code> будет считаться значением <code>false</code>.</li>
</ul>
<p>Составьте скрипт по следующему образцу:</p>
<div class="highlight"><code><code></code></code>
<pre><code><span class="k">class</span> <span class="nc">Script</span></code><br/><code><span class="p">{</span></code><br/><code>    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">Main</span><span class="p">()</span></code><br/><code>    <span class="p">{</span></code><br/><code>    <span class="c1">// Чтобы просмотреть доступные методы </span></code><br/><code>    <span class="c1">// в пространстве имён Comindware, </span></code><br/><code>    <span class="c1">// введите Comindware и точку</span></code><br/><code>        <span class="kt">var</span> <span class="n">result</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// или false</span></code><br/><code>        <span class="c1">// Добавьте код, который будет </span></code><br/><code>        <span class="c1">// менять возвращаемое значение.</span></code><br/><code>        <span class="k">return</span> <span class="n">result</span><span class="p">;</span></code><br/><code>    <span class="p">}</span></code><br/><code><span class="p">}</span></code></pre>
</div>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Проверить результат скрипта»" src="https://kb.comindware.ru/assets/scenario_actions_check_script_result.png"/></p>
<figcaption class="caption">Настройка действия «Проверить результат скрипта»</figcaption>
</figure>
<figure class="screenshot_with_caption">
<p><img alt="Пример сообщения действия «Проверить результат скрипта» в цепочке событий" src="https://kb.comindware.ru/assets/scenario_verify_expression_csharp_event_chain_message.png"/></p>
<figcaption class="caption">Пример сообщения действия «Проверить результат скрипта» в цепочке событий</figcaption>
</figure>
<h4 id="выполнить-по-условиям">Выполнить по условиям</h4>
<p>Это действие выполняет вложенные в него блоки действий по заданным условиям.</p>
<ul>
<li>Возможно применение нескольких условий. Для каждого условия внутри действия «<strong>Выполнить по условиям</strong>» создаётся блок для вложенных действий, которые выполняются, если выражение возвращает <code>true</code>.</li>
<li>Блок вложенных действий выполняется, если выражение для условия возвращает значение <code>true</code>.</li>
<li>Блоки вложенных действий выполняются последовательно по порядку условий в списке.</li>
<li>Если ни одно из условий не вернёт <code>true</code>, действие «<strong>Выполнить по условиям</strong>» и вложенные в него блоки действий будут пропущены.</li>
</ul>
<p>Настройте условия:</p>
<ul>
<li><strong>Создать</strong> — нажмите, чтобы добавить условие.</li>
<li><strong>Удалить</strong> — нажмите, чтобы удалить выбранные условия.</li>
<li><strong>Название условия</strong> — краткое описание условия.</li>
<li><strong>Выражение</strong> — задайте условие выполнения вложенных действий с помощью <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Выполнить по условиям»" src="https://kb.comindware.ru/assets/scenario_actions_execute_on_conditions.png"/></p>
<figcaption class="caption">Настройка действия «Выполнить по условиям»</figcaption>
</figure>
<h4 id="повторять-по-числовому-счётчику">Повторять по числовому счётчику</h4>
<p>Это действие выполняет вложенные в него действия заданное количество раз.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Переменная</strong> — переменная-счётчик, по которой будет выполняться цикл, аналогичная счётчику цикла <code>for</code>. Значение этой переменной будет увеличиваться <strong>от 0</strong> до значения, заданного в поле «<strong>Количество итераций</strong>», <strong>минус 1</strong>.</li>
<li><strong>Количество итераций</strong> — задайте количество повторений цикла посредством числового <strong>значения</strong>, <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Повторять по числовому счётчику»" src="https://kb.comindware.ru/assets/scenario_actions_counter_loop.png"/></p>
<figcaption class="caption">Настройка действия «Повторять по числовому счётчику»</figcaption>
</figure>
<h4 id="повторять-по-количеству-объектов">Повторять по количеству объектов</h4>
<p>Это действие выполняет вложенные в него действия над объектами, заданными с помощью <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Переменная</strong> — переменная-итератор, по которой будет выполняться цикл, аналогичная итератору цикла <code>for each</code>. Этой переменной будет присваиваться значение заданного атрибута или выражения.</li>
<li><strong>Атрибут или выражение для поиска объектов</strong> — задайте объекты, по которым требуется выполнить цикл, с помощью <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Повторять по количеству объектов»" src="https://kb.comindware.ru/assets/scenario_actions_object_loop.png"/></p>
<figcaption class="caption">Настройка действия «Повторять по количеству объектов»</figcaption>
</figure>
<h4 id="запустить-процесс">Запустить процесс</h4>
<p>Это действие создаёт экземпляр выбранного шаблона процесса.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Шаблон процесса</strong> — шаблон процесса, в котором будет создан новый экземпляр по текущей записи <a class="mkdocs_imported_link" href="#scenario_event_common_properties"><strong>контекстного шаблона</strong></a> (указан на вкладке «<strong>Дополнительно</strong>»).</li>
</ul>
<p>Чтобы запустить процесс по новой записи, перед этим действием необходимо выполнить действие «<strong>Создать запись</strong>».</p>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Запустить процесс»" src="https://kb.comindware.ru/assets/scenario_actions_execute_process.png"/></p>
<figcaption class="caption">Настройка действия «Запустить процесс»</figcaption>
</figure>
<h4 id="scenario_actions_send_message">Отправить сообщение</h4>
<p>Это действие отправляет сообщение посредством указанных подключения и пути передачи данных.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Подключение</strong> — подключение, которое будет использоваться для отправки сообщения.</li>
<li><strong>Путь передачи данных</strong> — путь передачи данных, который будет использоваться для формирования сообщения.</li>
<li><strong>Переменная с сообщением</strong> — имя переменой, в которой хранится содержимое сообщения. До вызова действия «<strong>Отправить сообщение</strong>» эта переменная должна быть инициализирована с помощью действия <a class="mkdocs_imported_link" href="#изменить-значения-переменных">«<strong>Изменить значения переменных</strong>»</a>. Это словарь типа ключ-значение, который указанный путь передачи данных преобразует в сообщение. Результирующее сообщение будет отправлено посредством указанного подключения.</li>
<li><strong>Переменная для успешного ответа</strong> — имя переменной, в которую будет помещён ответ сервера в случае успешной отправки сообщения.</li>
<li><strong>Переменная для ответа с ошибкой</strong> — имя переменной, в которую будет помещён ответ сервера в случае сбоя отправки сообщения.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Отправить сообщение»" src="https://kb.comindware.ru/assets/scenario_actions_send_message.png"/></p>
<figcaption class="caption">Настройка действия «Отправить сообщение»</figcaption>
</figure>
<h4 id="изменить-значения-переменных">Изменить значения переменных</h4>
<p>Это действие изменяет значение структурированного набора переменных указанным способом.</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Операция со значениями переменных</strong>
<ul>
<li><strong>Добавить</strong> — добавление в набор переменных и значений, указанных в таблице переменных.</li>
<li><strong>Заменить</strong> — установка в наборе переменных и значений, указанных в таблице переменных.</li>
<li><strong>Исключить</strong> — удаление из набора  всех переменных и значений.</li>
</ul>
</li>
<li><strong>Набор переменных</strong> — имя набора переменных, подлежащего изменению. Набор переменных представляет собой словарь типа ключ-значение.</li>
<li>Таблица переменных
<ul>
<li><strong>Создать</strong> — нажмите, чтобы добавить переменную и настроить изменение её значения.</li>
<li><strong>Удалить</strong> — нажмите, чтобы убрать выбранные переменные.</li>
<li><strong>Имя переменной</strong> — переменная, подлежащая изменению.</li>
<li><strong>Значение</strong> — задайте значение или список значений переменной с помощью <strong>атрибута</strong>, <strong>формулы</strong>, <strong>N3</strong> или <strong>DMN</strong>.</li>
</ul>
</li>
</ul>
<div class="notice notice-warning">
<p class="admonition-title">Переменные типа «Объект»</p>
<p>С помощью действия «<strong>Изменить значения переменных</strong>» можно передавать переменные типа «<strong>Объект</strong>». Для этого необходимо создать родительскую переменную и добавить к ней дочерние:</p>
<ul>
<li>Создайте переменную, оставив её значение пустым.</li>
<li>Установите флажок у имени родительской переменной в списке и нажмите кнопку «<strong>Создать</strong>».</li>
<li>Дважды нажмите значок <em class="fa-light fa-angle-down anchor">‌<!--icon--></em> рядом с родительской переменной.</li>
<li>В таблице отобразится дочерняя переменная.</li>
</ul>
</div>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Изменить значения переменных»" src="https://kb.comindware.ru/assets/scenario_actions_change_variable_values.png"/></p>
<figcaption class="caption">Настройка действия «Изменить значения переменных»</figcaption>
</figure>
<h4 id="изменить-значения-скриптом">Изменить значения скриптом</h4>
<p>Это действие изменяет значение указанных атрибутов определённым способом в записи <a class="mkdocs_imported_link" href="#scenario_event_common_properties">контекстного шаблона</a> (указан на вкладке «<strong>Дополнительно</strong>»).</p>
<p>Настройте действие:</p>
<ul>
<li><strong>Создать</strong> — нажмите, чтобы добавить атрибут и настроить изменение его значения.</li>
<li><strong>Удалить</strong> — нажмите, чтобы убрать выбранный атрибут.</li>
<li><strong>Атрибут</strong> — подлежащий изменению атрибут контекстного шаблона записи (указан на вкладке «<strong>Дополнительно</strong>»).</li>
<li><strong>Операция со значениями</strong>
<ul>
<li><strong>Заменить</strong> — установка в атрибуте значения, указанного в столбце «<strong>Значение</strong>».</li>
<li><strong>Удалить</strong> — удаление всех значений из атрибута.</li>
<li><strong>Добавить</strong> — добавление в атрибут значения, указанного в столбце «<strong>Значение</strong>» (этот пункт отображается для атрибутов типа «<strong>Запись</strong>», «<strong>Аккаунт</strong>», «<strong>Роль</strong>», «<strong>Организационная единица</strong>», «<strong>Документ</strong>», «<strong>Изображение</strong>» с установленным флажком «<strong>Хранить несколько значений</strong>»).</li>
<li><strong>Исключить</strong> — удаление из атрибута ссылок на объекты, указанные в столбце «<strong>Значение</strong>»  (этот пункт отображается для атрибутов типа «<strong>Запись</strong>», «<strong>Аккаунт</strong>», «<strong>Роль</strong>», «<strong>Организационная единица</strong>»,  «<strong>Документ</strong>», «<strong>Изображение</strong>» с установленным флажком «<strong>Хранить несколько значений</strong>»). Сами связанные объекты при этом удалены не будут.</li>
</ul>
</li>
<li><strong>Значение</strong> — задайте значение или список значений атрибута посредством C#-скрипта.</li>
</ul>
<p>Составьте скрипт по следующему образцу:</p>
<div class="highlight"><code><code></code></code>
<pre><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Script</span> <span class="p">{</span></code><br/><code>    <span class="c1">// Выберите тип метода Main() в зависимости от типа атрибута:</span></code><br/><code>    <span class="c1">// string — Текст, int, decimal — Число, dateTime — Дата и время,</span></code><br/><code>    <span class="c1">// bool — Логический, TimeSpan — Длительность, </span></code><br/><code>    <span class="c1">// IEnumerable&lt;string&gt; — Список значений.</span></code><br/><code>    <span class="c1">// ObjectID — переменная, в которой хранится ID экземпляра шаблона записи,</span></code><br/><code>    <span class="c1">// в контексте которого выполняется скрипт.</span></code><br/><code>    <span class="c1">// Чтобы просмотреть доступные методы </span></code><br/><code>    <span class="c1">// в пространстве имён Comindware, </span></code><br/><code>    <span class="c1">// введите Comindware и точку</span></code><br/><code></code><br/><code>    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span> <span class="n">ObjectID</span><span class="p">)</span> <span class="p">{</span>         </code><br/><code>        <span class="kt">var</span> <span class="n">result</span> <span class="o">=</span> <span class="s">"Текстовый результат действия «Изменить значения скриптом»"</span><span class="p">;</span></code><br/><code>        <span class="k">return</span> <span class="n">result</span><span class="p">;</span></code><br/><code>    <span class="p">}</span></code><br/><code><span class="p">}</span></code></pre>
</div>
<figure class="screenshot_with_caption">
<p><img alt="Настройка действия «Изменить значения скриптом»" src="https://kb.comindware.ru/assets/scenario_actions_change_value_script.png"/></p>
<figcaption class="caption">Настройка действия «Изменить значения скриптом»</figcaption>
</figure>
<h2 id="связанные-статьи">Связанные статьи</h2>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4717">Сценарии. Определение, создание, настройка, использование</a></strong></p>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4719">Использование переменных в сценарии</a></strong></p>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4919">Сценарий. Проверка данных записи перед сохранением</a></strong></p>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article\.php\?id=4929">Отладка формул, выражений N3, сценариев и C#-скриптов</a></strong></p>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#"> <em class="fa-light fa-arrow-up">‌<!--icon--></em> К началу </a></div>